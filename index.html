<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATLAS RTO - Workforce Matrix Report</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f5f5f5; padding: 20px; line-height: 1.6; color: #333; }
        .container { max-width: 1200px; margin: 0 auto; background-color: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header { text-align: center; margin-bottom: 30px; border-bottom: 3px solid #9370db; padding-bottom: 20px; }
        .header h1 { color: #9370db; font-size: 28px; margin-bottom: 5px; }
        .header p { color: #666; font-size: 14px; }
        .controls { display: flex; gap: 15px; margin-bottom: 25px; align-items: center; flex-wrap: wrap; }
        .controls label { font-weight: bold; color: #333; }
        .controls select { padding: 10px 15px; border: 2px solid #9370db; border-radius: 4px; font-size: 14px; cursor: pointer; min-width: 300px; }
        .navigation { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
        button { padding: 10px 20px; background-color: #9370db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; transition: background-color 0.3s; }
        button:hover { background-color: #7851a9; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        .print-button { background-color: #7851a9; }
        .print-button:hover { background-color: #5d3f85; }

        /* Login Corner */
        .login-corner { position: fixed; top: 20px; right: 20px; z-index: 1000; }
        .login-btn { padding: 8px 16px; background-color: #9370db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .login-btn:hover { background-color: #7851a9; }
        .login-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 2000; }
        .login-modal.active { display: flex; align-items: center; justify-content: center; }
        .login-box { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); max-width: 400px; width: 90%; }
        .login-box h2 { color: #9370db; margin-bottom: 20px; text-align: center; }
        .login-form-group { margin-bottom: 15px; }
        .login-form-group label { display: block; margin-bottom: 5px; font-weight: 600; color: #333; font-size: 13px; }
        .login-form-group input, .login-form-group select { width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 4px; font-size: 14px; }
        .login-form-group input:focus, .login-form-group select:focus { border-color: #9370db; outline: none; }
        .login-actions { display: flex; gap: 10px; margin-top: 20px; }
        .login-actions button { flex: 1; padding: 10px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; }
        .login-submit { background-color: #9370db; color: white; }
        .login-submit:hover { background-color: #7851a9; }
        .login-cancel { background-color: #ddd; color: #333; }
        .login-cancel:hover { background-color: #ccc; }
        .user-info { background-color: #f3e5ff; padding: 8px 16px; border-radius: 4px; font-size: 12px; color: #666; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .user-info strong { color: #9370db; }
        .logout-btn { margin-left: 10px; padding: 4px 10px; background-color: #9370db; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 11px; }
        .logout-btn:hover { background-color: #7851a9; }
        .error-msg { color: #d32f2f; font-size: 12px; margin-top: 5px; display: none; }

        .current-staff-info { font-size: 13px; color: #666; padding: 10px; background-color: #f3e5ff; border-radius: 4px; }
        .staff-section { margin-bottom: 30px; page-break-inside: avoid; }
        .section-header { background-color: #9370db; color: white; padding: 12px 15px; margin-bottom: 15px; font-size: 14px; font-weight: bold; border-radius: 4px; }
        .staff-name { font-size: 20px; font-weight: bold; color: #9370db; margin-bottom: 10px; padding: 10px; background-color: #f3e5ff; border-left: 4px solid #9370db; }
        .atlas-id { font-family: 'Courier New', monospace; font-weight: bold; color: #666; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 13px; }
        th { background-color: #e6d9f5; color: #9370db; padding: 10px; text-align: left; border: 1px solid #ccc; font-weight: 600; }
        td { padding: 10px; border: 1px solid #ddd; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        tr:hover { background-color: #f3e5ff; }

        .contact-groups { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        .contact-group { border: 1px solid #ddd; border-radius: 4px; background-color: #f9f9f9; padding: 12px; }
        .contact-group-title { font-weight: bold; color: #9370db; border-bottom: 2px solid #e6d9f5; padding-bottom: 8px; margin-bottom: 10px; font-size: 12px; }
        .contact-item { margin-bottom: 10px; font-size: 12px; }
        .contact-label { font-weight: 600; color: #9370db; font-size: 11px; }
        .contact-value { color: #333; font-size: 12px; margin-top: 2px; }
        .empty-section { padding: 15px; color: #999; font-style: italic; background-color: #f5f5f5; border: 1px dashed #ccc; border-radius: 4px; }

        .soa-section { background-color: #f9f9f9; padding: 15px; border-radius: 4px; margin-bottom: 20px; }
        .soa-item { margin-bottom: 12px; padding-bottom: 10px; border-bottom: 1px dotted #ddd; font-size: 13px; }
        .soa-item:last-child { border-bottom: none; }
        .soa-statement { font-weight: 500; color: #9370db; margin-bottom: 5px; }
        .soa-meta { color: #666; font-size: 12px; margin-left: 10px; }

        /* Editable fields */
        .editable { cursor: pointer; padding: 2px 4px; border-radius: 3px; transition: all 0.2s; position: relative; display: inline-block; }
        .editable:hover { background-color: #fff3cd; box-shadow: 0 0 0 2px #ffc107; }
        .editable::after { content: '‚úèÔ∏è'; font-size: 10px; opacity: 0; transition: opacity 0.2s; }
        .editable:hover::after { opacity: 1; }
        .editable.editing { background-color: #e3f2fd; outline: 2px solid #2196f3; }
        .editable.editing::after { display: none; }
        .edit-hint { background-color: #e3f2fd; padding: 10px 15px; border-radius: 4px; margin-bottom: 15px; font-size: 12px; color: #1976d2; border-left: 4px solid #2196f3; }
        .edit-input { width: 100%; padding: 6px; border: 2px solid #9370db; border-radius: 4px; font-size: 12px; }

        .action-buttons { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .add-btn { background-color: #4caf50; }
        .add-btn:hover { background-color: #45a049; }
        .delete-btn { background-color: #f44336; }
        .delete-btn:hover { background-color: #da190b; }
        .export-btn { background-color: #ff9800; }
        .export-btn:hover { background-color: #e68900; }
        .reports-btn { background-color: #2196f3; }
        .reports-btn:hover { background-color: #1976d2; }

        /* Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 2000; overflow-y: auto; }
        .modal.active { display: flex; align-items: center; justify-content: center; padding: 20px; }
        .modal-content { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); max-width: 800px; width: 100%; max-height: 90vh; overflow-y: auto; }
        .modal-content.large { max-width: 1200px; }
        .modal-content h2 { color: #9370db; margin-bottom: 20px; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 600; color: #333; font-size: 13px; }
        .form-group input, .form-group select { width: 100%; padding: 8px; border: 2px solid #ddd; border-radius: 4px; font-size: 14px; }
        .form-group input:focus, .form-group select:focus { border-color: #9370db; outline: none; }
        .form-group.full-width { grid-column: 1 / -1; }
        .modal-actions { display: flex; gap: 10px; margin-top: 20px; }
        .modal-actions button { flex: 1; padding: 10px; }
        .save-btn { background-color: #4caf50; color: white; }
        .save-btn:hover { background-color: #45a049; }
        .cancel-btn { background-color: #ddd; color: #333; }
        .cancel-btn:hover { background-color: #ccc; }

        .change-log { max-height: 400px; overflow-y: auto; }
        .log-entry { padding: 10px; margin-bottom: 10px; background-color: #f9f9f9; border-left: 4px solid #9370db; border-radius: 4px; font-size: 12px; }
        .log-timestamp { font-weight: bold; color: #9370db; }
        .log-action { color: #666; margin-top: 5px; }

        /* Report Styles */
        .report-filters { display: flex; gap: 15px; margin-bottom: 20px; padding: 15px; background-color: #f3e5ff; border-radius: 4px; flex-wrap: wrap; }
        .filter-group { display: flex; flex-direction: column; gap: 5px; }
        .filter-group label { font-weight: 600; font-size: 12px; color: #9370db; }
        .filter-group select { padding: 8px; border: 2px solid #9370db; border-radius: 4px; font-size: 13px; }
        .report-summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .summary-card { padding: 15px; border-radius: 8px; text-align: center; color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .summary-card.expired { background: linear-gradient(135deg, #f44336 0%, #e91e63 100%); }
        .summary-card.this-month { background: linear-gradient(135deg, #ff9800 0%, #ff5722 100%); }
        .summary-card.soon { background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); }
        .summary-card.valid { background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%); }
        .summary-number { font-size: 32px; font-weight: bold; margin-bottom: 5px; }
        .summary-label { font-size: 13px; opacity: 0.9; }
        .report-table { margin-top: 20px; }
        .status-badge { display: inline-block; padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600; text-transform: uppercase; }
        .status-expired { background-color: #ffebee; color: #c62828; }
        .status-this-month { background-color: #fff3e0; color: #e65100; }
        .status-soon { background-color: #fffde7; color: #f57f17; }
        .status-valid { background-color: #e8f5e9; color: #2e7d32; }
        .report-actions { display: flex; gap: 10px; margin-bottom: 20px; }

        @media print {
            .controls, .navigation, button, .login-corner, .action-buttons { display: none !important; }
            .container { box-shadow: none; padding: 0; }
            .editable { cursor: default; }
            .editable:hover { background-color: transparent; }
        }
    </style>
</head>
<body>

    <!-- Login Corner -->
    <div class="login-corner" id="loginCorner">
        <button class="login-btn" onclick="showLoginModal()">üîê Login</button>
    </div>

    <!-- Add Staff Modal -->
    <div class="modal" id="addStaffModal">
        <div class="modal-content">
            <h2>‚ûï Add New Workforce Member</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label for="newFirstName">First Name *</label>
                    <input type="text" id="newFirstName" required>
                </div>
                <div class="form-group">
                    <label for="newMiddleName">Middle Name</label>
                    <input type="text" id="newMiddleName">
                </div>
                <div class="form-group">
                    <label for="newSurname">Surname *</label>
                    <input type="text" id="newSurname" required>
                </div>
                <div class="form-group">
                    <label for="newDOB">Date of Birth (dd-mmm-yyyy)</label>
                    <input type="text" id="newDOB" placeholder="e.g. 15-Jan-1980">
                </div>
                <div class="form-group">
                    <label for="newType">Type of Workforce *</label>
                    <select id="newType" required>
                        <option value="">-- Select --</option>
                        <option value="Contractor">Contractor</option>
                        <option value="Staff">Staff</option>
                        <option value="Casual Employee">Casual Employee</option>
                        <option value="Pending">Pending</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newState">State</label>
                    <select id="newState">
                        <option value="">-- Select --</option>
                        <option value="NSW">NSW</option>
                        <option value="VIC">VIC</option>
                        <option value="QLD">QLD</option>
                        <option value="SA">SA</option>
                        <option value="WA">WA</option>
                        <option value="TAS">TAS</option>
                        <option value="NT">NT</option>
                        <option value="ACT">ACT</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newStatus">Team Status *</label>
                    <select id="newStatus" required>
                        <option value="">-- Select --</option>
                        <option value="Active">Active</option>
                        <option value="Inactive">Inactive</option>
                        <option value="In Progress">In Progress</option>
                        <option value="Pending">Pending</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newMobile">Mobile Number</label>
                    <input type="text" id="newMobile" placeholder="e.g. 0400-000-000">
                </div>
                <div class="form-group full-width">
                    <label for="newEmail">Email</label>
                    <input type="email" id="newEmail">
                </div>
                <div class="form-group full-width">
                    <label for="newAddress">Address</label>
                    <input type="text" id="newAddress">
                </div>
            </div>
            <div class="modal-actions">
                <button class="cancel-btn" onclick="hideAddStaffModal()">Cancel</button>
                <button class="save-btn" onclick="saveNewStaff()">‚ûï Add Workforce</button>
            </div>
        </div>
    </div>

    <!-- Change Log Modal -->
    <div class="modal" id="changeLogModal">
        <div class="modal-content">
            <h2>üìã Change Log</h2>
            <div class="change-log" id="changeLogContent">
                <p style="text-align: center; color: #999;">No changes recorded yet.</p>
            </div>
            <div class="modal-actions">
                <button class="cancel-btn" onclick="hideChangeLogModal()">Close</button>
            </div>
        </div>
    </div>        <!-- State Reports Modal -->
    <div class="modal" id="stateReportsModal">
        <div class="modal-content large">
            <h2>üó∫Ô∏è State Reports</h2>
            <div class="report-actions">
                <button onclick="printStateReport()">üñ®Ô∏è Print Report</button>
                <button onclick="exportStateReportCSV()">üíæ Export to CSV</button>
            </div>
            <div id="stateReportContent">
                <!-- State report will be inserted here -->
            </div>
            <div class="modal-actions">
                <button class="cancel-btn" onclick="hideStateReportsModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- SOA Reports Modal -->
    <div class="modal" id="soaReportsModal">
        <div class="modal-content large">
            <h2>üìú Statement of Attainment Reports</h2>
            <div class="report-filters">
                <div class="filter-group">
                    <label>Select SOA Class:</label>
                    <select id="soaClassFilter" onchange="updateSOAReport()">
                        <option value="">-- Select SOA Class --</option>
                    </select>
                </div>
            </div>
            <div class="report-actions">
                <button onclick="printSOAReport()">üñ®Ô∏è Print Report</button>
                <button onclick="exportSOAReportCSV()">üíæ Export to CSV</button>
            </div>
            <div id="soaReportContent">
                <!-- SOA report will be inserted here -->
            </div>
            <div class="modal-actions">
                <button class="cancel-btn" onclick="hideSOAReportsModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Expiry Reports Modal -->
    <div class="modal" id="reportsModal">
        <div class="modal-content large">
            <h2>üìä Expiry Reports Dashboard</h2>
            <div class="report-filters">
                <div class="filter-group">
                    <label>Document Type:</label>
                    <select id="reportDocType" onchange="updateReport()">
                        <option value="all">All Documents</option>
                        <option value="police">Police Checks</option>
                        <option value="insurance">Insurance (Indemnity & Liability)</option>
                        <option value="hrw">HRW Licences</option>
                        <option value="drivers">Driver's Licences</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Status Filter:</label>
                    <select id="reportStatus" onchange="updateReport()">
                        <option value="all">All Statuses</option>
                        <option value="expired">Expired Only</option>
                        <option value="this-month">This Month Only</option>
                        <option value="soon">Expiring Soon Only</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Team Status:</label>
                    <select id="reportTeamStatus" onchange="updateReport()">
                        <option value="all">All Staff</option>
                        <option value="Active">Active Only</option>
                        <option value="Inactive">Inactive Only</option>
                        <option value="In Progress">In Progress Only</option>
                    </select>
                </div>
            </div>
            <div class="report-summary" id="reportSummary">
                <!-- Summary cards will be inserted here -->
            </div>
            <div class="report-actions">
                <button onclick="printReport()">üñ®Ô∏è Print Report</button>
                <button onclick="exportReportCSV()">üíæ Export to CSV</button>
            </div>
            <div class="report-table" id="reportTable">
                <!-- Report table will be inserted here -->
            </div>
            <div class="modal-actions">
                <button class="cancel-btn" onclick="hideReportsModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="login-modal" id="loginModal">
        <div class="login-box">
            <h2>Login to Edit Mode</h2>
            <div class="login-form-group">
                <label for="userRole">User Role:</label>
                <select id="userRole" onchange="togglePasswordField()">
                    <option value="">-- Select Role --</option>
                    <option value="readonly">Read-Only (No Password)</option>
                    <option value="user">User - Stacy</option>
                    <option value="admin">Administrator - Judy</option>
                </select>
            </div>
            <div class="login-form-group" id="passwordGroup" style="display:none;">
                <label for="userPassword">Password:</label>
                <input type="password" id="userPassword" placeholder="Enter password">
                <div class="error-msg" id="errorMsg">Incorrect password. Please try again.</div>
            </div>
            <div class="login-actions">
                <button class="login-cancel" onclick="hideLoginModal()">Cancel</button>
                <button class="login-submit" onclick="handleLogin()">Login</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1>ATLAS RTO - Workforce Matrix Report</h1>
            <p>Ausload Shifting Training Solutions</p>
        </div>

        <div class="action-buttons" id="actionButtons" style="display: none;">
            <button class="add-btn" onclick="showAddStaffModal()">‚ûï Add Workforce</button>
            <button class="delete-btn" onclick="deleteStaff()" id="deleteBtn" style="display: none;">üóëÔ∏è Delete Current</button>
            <button class="export-btn" onclick="exportData()">üíæ Export Data</button>
            <button onclick="showImportDialog()">üì• Import Data</button>
            <button onclick="showChangeLogModal()">üìã Change Log</button>
        </div>

        <div style="margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
            <button class="reports-btn" onclick="showReportsModal()">üìä Expiry Reports</button>
            <button class="reports-btn" onclick="showStateReportsModal()">üó∫Ô∏è State Reports</button>
            <button class="reports-btn" onclick="showSOAReportsModal()">üìú SOA Reports</button>
        </div>

        <div class="controls">
            <label for="staffSelect">Select Staff Member:</label>
            <select id="staffSelect" onchange="loadStaffData()">
                <option value="">-- Select --</option>
            </select>
        </div>

        <div class="navigation">
            <button onclick="previousStaff()" id="prevBtn">‚óÄ Previous</button>
            <button onclick="nextStaff()" id="nextBtn">Next ‚ñ∂</button>
            <button onclick="window.print()" class="print-button">üñ®Ô∏è Print</button>
        </div>

        <div class="current-staff-info" id="staffInfo" style="display: none;">
            Viewing: <span id="currentStaffName"></span>
        </div>

        <div class="edit-hint" id="editHint" style="display: none;">
            <strong>üí° Editing Enabled:</strong> Hover over contact field values and click the ‚úèÔ∏è icon to edit. Press Enter to save, Escape to cancel.
        </div>

        <div id="staffDetails"></div>
    </div>

    <script>
        // Data structures
        const staffData = {
            "ADAMDavid": {"firstName":"David","middleName":"William Laurence","surname":"ADAM","atlasId":"ADAMDavid","typeOfWorkforce":"Contractor","state":"NSW","teamStatus":"Active","dateOfBirth":"12-Mar-1960","mobileNumber":"0409-992-215","email":"auskie1@optusnet.com.au","address":"23 Picasso Cresent, Old Toongabbie, NSW, 2146"},
            "ALDREDTrevor": {"firstName":"Trevor","middleName":"Mark","surname":"ALDRED","atlasId":"ALDREDTrevor","typeOfWorkforce":"Contractor","state":"NSW","teamStatus":"Active","dateOfBirth":"13-May-1961","mobileNumber":"0421-086-932","email":"trevmark@gmail.com","address":"7 Shannon Parade, Berkely Vale, NSW, 2261"},
            "BEECHINGRoss": {"firstName":"Ross","middleName":"","surname":"BEECHING","atlasId":"BEECHINGRoss","typeOfWorkforce":"Contractor","state":"NSW","teamStatus":"Active","dateOfBirth":"20-Nov-1983","mobileNumber":"0402-583-932","email":"ross@rastraining.com.au","address":"19 Kelly Circle, Rutherford, NSW, 2320"},
            "CHEESEMANGlenn": {"firstName":"Glenn","middleName":"Michael","surname":"CHEESEMAN","atlasId":"CHEESEMANGlenn","typeOfWorkforce":"Contractor","state":"QLD","teamStatus":"Active","dateOfBirth":"07-May-1960","mobileNumber":"0437-392-964","email":"glennc427@gmail.com","address":"173 Coonowrin Road, Glass House Mountains, QLD, 4518"},
            "COURTWOODWilliam": {"firstName":"William","middleName":"James","surname":"COURTWOOD","atlasId":"COURTWOODWilliam","typeOfWorkforce":"Staff","state":"NSW","teamStatus":"Active","dateOfBirth":"05-Oct-1999","mobileNumber":"0478-110-660","email":"will.courtwood@gmail.com","address":"17 Aurburn Street, Parramatta, NSW, 2150"},
            "CUMPSTYAdam": {"firstName":"Adam","middleName":"John","surname":"CUMPSTY","atlasId":"CUMPSTYAdam","typeOfWorkforce":"Casual Employee","state":"WA","teamStatus":"Active","dateOfBirth":"16-Jun-1981","mobileNumber":"0413-560-654","email":"actrainingsolutions@gmail.com","address":"17 Springveiw Circle, Bennett Springs, WA, 6063"},
            "EDWARDFORDTrinden": {"firstName":"Trinden","middleName":"Janet","surname":"EDWARD-FORD","atlasId":"EDWARDFORDTrinden","typeOfWorkforce":"Contractor","state":"WA","teamStatus":"Active","dateOfBirth":"21-Feb-1986","mobileNumber":"","email":"tnetraining@gmail.com","address":"5 Burabur Street, Gosnells, WA, 6110"},
            "EDWARDSJason": {"firstName":"Jason","middleName":"Mark","surname":"EDWARDS","atlasId":"EDWARDSJason","typeOfWorkforce":"Contractor","state":"NSW","teamStatus":"Inactive","dateOfBirth":"04-Jul-1972","mobileNumber":"0401-360-997","email":"jason@elevatedtraining.com.au","address":"86 Dry Dock Road, Tweed Heads South, NSW, 2486"},
            "FRASERDavid": {"firstName":"David","middleName":"Craig","surname":"FRASER","atlasId":"FRASERDavid","typeOfWorkforce":"Contractor","state":"NSW","teamStatus":"Active","dateOfBirth":"09-Dec-1968","mobileNumber":"0419-018-585","email":"david@rocksolidtraining.com.au","address":"15 Lighthorse Drive, Woonona, NSW, 2517"},
            "HALLAndrew": {"firstName":"Andrew","middleName":"B","surname":"HALL","atlasId":"HALLAndrew","typeOfWorkforce":"Staff","state":"VIC","teamStatus":"Active","dateOfBirth":"15-Apr-1968","mobileNumber":"0411-947-620","email":"threehalfbricks@gmail.com","address":"Unit 4/65 Herbert Street, Mornington, NSW, 3139"},
            "HAMMONDSDarby": {"firstName":"Darby","middleName":"Thomas","surname":"HAMMONDS","atlasId":"HAMMONDSDarby","typeOfWorkforce":"Contractor","state":"NSW","teamStatus":"Active","dateOfBirth":"04-Jul-1990","mobileNumber":"0438-223-407","email":"darby.hammonds@gmail.com","address":"9 Wandu Road, Crangan, NSW, 2259"},
            "JAMIESONKerily": {"firstName":"Kerily","middleName":"Enid","surname":"JAMIESON","atlasId":"JAMIESONKerily","typeOfWorkforce":"Contractor","state":"TAS","teamStatus":"Active","dateOfBirth":"22-Sep-1964","mobileNumber":"0400-634-465","email":"kerily@iinet.net.au","address":"160 Caroline Street, Devonport, TAS, 7310"},
            "JOSEPHDavid": {"firstName":"David","middleName":"Anthony","surname":"JOSEPH","atlasId":"JOSEPHDavid","typeOfWorkforce":"Contractor","state":"NSW","teamStatus":"Active","dateOfBirth":"29-Apr-1966","mobileNumber":"0419-627-668","email":"djoseph747@gmail.com","address":"2A Phillip Street, South Coogee, NSW, 2035"},
            "LANGLEYMichael": {"firstName":"Michael","middleName":"","surname":"LANGLEY","atlasId":"LANGLEYMichael","typeOfWorkforce":"Contractor","state":"NSW","teamStatus":"In Progress","dateOfBirth":"17-Aug-1964","mobileNumber":"0401-071-361","email":"michaellangleyjp@gmail.com","address":"69 Kingswood Road, Engadine, NSW, 2233"},
            "LOOMBADevjit": {"firstName":"Devjit","middleName":"Singh","surname":"LOOMBA","atlasId":"LOOMBADevjit","typeOfWorkforce":"Staff","state":"QLD","teamStatus":"Active","dateOfBirth":"10-Jan-1970","mobileNumber":"0452-284-270","email":"devjitloomba@yahoo.com","address":"80 Parklan Drive, Walloon, QLD, 4306"},
            "MAKSIMOVICMiler": {"firstName":"Miler","middleName":"","surname":"MAKSIMOVIC","atlasId":"MAKSIMOVICMiler","typeOfWorkforce":"Contractor","state":"VIC","teamStatus":"Active","dateOfBirth":"23-Aug-1972","mobileNumber":"0419-569-917","email":"milerm@live.com.au","address":"54 Powlett Street, Altona Meadows, VIC, 3028"},
            "MCIVERAnthony": {"firstName":"Anthony","middleName":"James","surname":"MCIVER","atlasId":"MCIVERAnthony","typeOfWorkforce":"Contractor","state":"SA","teamStatus":"Active","dateOfBirth":"26-Jan-1964","mobileNumber":"0413-777-812","email":"milerm@live.com.au","address":"45 Corunna Avenue, Colonel Light Gardens, SA, 5041"},
            "PAGANODavid": {"firstName":"David","middleName":"","surname":"PAGANO","atlasId":"PAGANODavid","typeOfWorkforce":"Pending","state":"NA","teamStatus":"Pending","dateOfBirth":"","mobileNumber":"","email":"","address":"No data available"},
            "SHRUTTSHOTTON": {"firstName":"Andrew","middleName":"John","surname":"SHRUTT-SHOTTON","atlasId":"SHRUTTSHOTTON","typeOfWorkforce":"Contractor","state":"QLD","teamStatus":"Active","dateOfBirth":"12-May-1966","mobileNumber":"0423-211-100","email":"andy@tekneek.com.au","address":"7a Yoomba Crescent, Alexander Headlands, QLD, 4572"},
            "TSOURISPeter": {"firstName":"Peter","middleName":"","surname":"TSOURIS","atlasId":"TSOURISPeter","typeOfWorkforce":"Pending","state":"NA","teamStatus":"Pending","dateOfBirth":"","mobileNumber":"","email":"","address":"No data available"},
            "VIEIRARenan": {"firstName":"Renan","middleName":"Varella","surname":"VIEIRA","atlasId":"VIEIRARenan","typeOfWorkforce":"Contractor","state":"NSW","teamStatus":"Active","dateOfBirth":"14-Feb-1983","mobileNumber":"0424-548-487","email":"renan@safetyaustraliatraining.com.au","address":"1 Drummond Road, Oyster Bay, NSW, 2225"},
            "WILSONMelvin": {"firstName":"Melvin","middleName":"Douglas","surname":"WILSON","atlasId":"WILSONMelvin","typeOfWorkforce":"Contractor","state":"VIC","teamStatus":"Active","dateOfBirth":"24-Jan-1971","mobileNumber":"0400-888-816","email":"pomechef@bigpond.com","address":"8 Jacka Road, Avonsleigh, VIC, 3782"}
        };

        const policeData = {
            "ADAMDavid": {"checkDate":"13-Oct-2025","expiry":"13-Oct-2027","result":"No Disclosable Court Outcomes"},
            "ALDREDTrevor": {"checkDate":"09-Feb-2016","expiry":"09-Feb-2018","result":"No Disclosable Court Outcomes"},
            "BEECHINGRoss": {"checkDate":"31-Oct-2025","expiry":"31-Oct-2027","result":"No Disclosable Court Outcomes"},
            "CHEESEMANGlenn": {"checkDate":"20-Oct-2025","expiry":"20-Oct-2027","result":"No Disclosable Court Outcomes"},
            "COURTWOODWilliam": {"checkDate":"12-Oct-2025","expiry":"12-Oct-2025","result":"No Disclosable Court Outcomes"},
            "CUMPSTYAdam": {"checkDate":"09-Oct-2025","expiry":"09-Oct-2027","result":"No Disclosable Court Outcomes"},
            "FRASERDavid": {"checkDate":"17-Oct-2025","expiry":"17-Oct-2027","result":"No Disclosable Court Outcomes"},
            "HALLAndrew": {"checkDate":"17-Oct-2025","expiry":"17-Oct-2027","result":"No Disclosable Court Outcomes"},
            "HAMMONDSDarby": {"checkDate":"05-Aug-2024","expiry":"05-Aug-2026","result":"No Disclosable Court Outcomes"},
            "JAMIESONKerily": {"checkDate":"15-Oct-2025","expiry":"15-Oct-2027","result":"No Disclosable Court Outcomes"},
            "JOSEPHDavid": {"checkDate":"18-Oct-2025","expiry":"18-Oct-2027","result":"No Disclosable Court Outcomes"},
            "LOOMBADevjit": {"checkDate":"10-Oct-2025","expiry":"10-Oct-2027","result":"No Disclosable Court Outcomes"},
            "MAKSIMOVICMiler": {"checkDate":"09-Oct-2025","expiry":"09-Oct-2027","result":"No Disclosable Court Outcomes"},
            "MCIVERAnthony": {"checkDate":"06-May-2025","expiry":"06-May-2027","result":"Requires additional Action","comments":"ACT2025-017 Form FRM201B Submitted"},
            "SHRUTTSHOTTON": {"checkDate":"08-Oct-2025","expiry":"08-Oct-2027","result":"No Disclosable Court Outcomes"},
            "VIEIRARenan": {"checkDate":"13-Oct-2025","expiry":"13-Oct-2027","result":"No Disclosable Court Outcomes"},
            "WILSONMelvin": {"checkDate":"23-Feb-2024","expiry":"23-Feb-2026","result":"No Disclosable Court Outcomes"}
        };

        const insuranceData = {
            "ADAMDavid": {"indemnity":"On File","indemnityStart":"30-Jun-2025","indemnityExpiry":"30-Jun-2026","indemnityPolicy":"AU00022515-003","liability":"On File","liabilityStart":"30-Jun-2025","liabilityExpiry":"30-Jun-2026","liabilityPolicy":"78 TRANZNT LIA"},
            "ALDREDTrevor": {"indemnity":"Casual Employee","liability":"Casual Employee"},
            "BEECHINGRoss": {"indemnity":"On File","indemnityStart":"31-Jan-2025","indemnityExpiry":"31-Jan-2026","indemnityPolicy":"AU00070942-000","liability":"On File","liabilityStart":"31-Jan-2025","liabilityExpiry":"31-Jan-2026","liabilityPolicy":"AU00080943-000"},
            "CHEESEMANGlenn": {"indemnity":"On File","indemnityStart":"08-Oct-2025","indemnityExpiry":"08-Oct-2026","indemnityPolicy":"P00423243","liability":"On File","liabilityStart":"08-Oct-2025","liabilityExpiry":"08-Oct-2026","liabilityPolicy":"P00423243"},
            "COURTWOODWilliam": {"indemnity":"Staff","liability":"Staff"},
            "EDWARDFORDTrinden": {"indemnity":"On File","indemnityStart":"15-Oct-2025","indemnityExpiry":"15-Oct-2026","indemnityPolicy":"IMO131A7F335","liability":"On File","liabilityStart":"15-Oct-2025","liabilityExpiry":"15-Oct-2026","liabilityPolicy":"IMO131A7F335"},
            "FRASERDavid": {"indemnity":"On File","indemnityStart":"30-Jun-2025","indemnityExpiry":"30-Jun-2026","indemnityPolicy":"AU00022599-003","liability":"On File","liabilityStart":"30-Jun-2025","liabilityExpiry":"30-Jun-2026","liabilityPolicy":"78 TRANZNT LIA"},
            "HALLAndrew": {"indemnity":"Staff","liability":"Staff"},
            "HAMMONDSDarby": {"indemnity":"On File","indemnityStart":"10-Feb-2025","indemnityExpiry":"10-Feb-2026","indemnityPolicy":"AU00081174-000","liability":"On File","liabilityStart":"10-Feb-2025","liabilityExpiry":"10-Feb-2026","liabilityPolicy":"AU00081175-000"},
            "JAMIESONKerily": {"indemnity":"On File","indemnityStart":"30-Jun-2025","indemnityExpiry":"30-Jun-2026","indemnityPolicy":"AU00022562-003","liability":"On File","liabilityStart":"30-Jun-2025","liabilityExpiry":"30-Jun-2026","liabilityPolicy":"78 TRANZNT LIA"},
            "LOOMBADevjit": {"indemnity":"Staff","liability":"Staff"},
            "MAKSIMOVICMiler": {"liability":"On File","liabilityStart":"03-Nov-2023","liabilityExpiry":"02-Nov-2024","liabilityPolicy":"OA49823462"},
            "MCIVERAnthony": {"indemnity":"On File","indemnityStart":"31-Jul-2025","indemnityExpiry":"31-Jul-2026","indemnityPolicy":"201805-1317 R7 BIA","liability":"On File","liabilityStart":"31-Jul-2025","liabilityExpiry":"31-Jul-2026","liabilityPolicy":"201805-1317 R7 BIA"},
            "SHRUTTSHOTTON": {"indemnity":"On File","indemnityStart":"30-Nov-2024","indemnityExpiry":"30-Nov-2025","indemnityPolicy":"PSN0040164966","liability":"On File","liabilityStart":"31-Oct-2024","liabilityExpiry":"31-Oct-2025","liabilityPolicy":"124U342200BPK"},
            "VIEIRARenan": {"indemnity":"On File","indemnityStart":"12-Sep-2025","indemnityExpiry":"12-Sep-2026","indemnityPolicy":"SOB3906200025P","liability":"On File","liabilityStart":"12-Sep-2025","liabilityExpiry":"12-Sep-2026","liabilityPolicy":"PB3906200025P"},
            "WILSONMelvin": {"indemnity":"On File","indemnityStart":"22-Mar-2025","indemnityExpiry":"22-Mar-2026","indemnityPolicy":"SOB1284600025p","liability":"On File","liabilityStart":"22-Mar-2025","liabilityExpiry":"22-Mar-2026","liabilityPolicy":"18U276700BPK"}
        };

        const hrwData = {
            "ADAMDavid": [{"name":"SafeWork NSW National Licence to Perform High Risk Work","state":"NSW","number":"HRW047164","issueDate":"20-Dec-2007","expiry":"20-Dec-2027","classes":"WP LF LO HP"},{"name":"SafeWork NSW Accredited Assessor High Risk Work","state":"NSW","number":"HN196837","issueDate":"17-Feb-1999","expiry":"17-Feb-2028","classes":"WP LF LO"}],
            "ALDREDTrevor": [{"name":"SafeWork NSW National Licence to Perform High Risk Work","state":"NSW","number":"HRW185591","issueDate":"05-May-2009","expiry":"05-May-2029","classes":"LF"},{"name":"SafeWork NSW Accredited Assessor High Risk Work","state":"NSW","number":"HN01003","issueDate":"14-Oct-2011","expiry":"14-Oct-2026","classes":"LF"}],
            "BEECHINGRoss": [{"name":"SafeWork NSW National Licence to Perform High Risk Work","state":"NSW","number":"HRW971914","issueDate":"03-Apr-2023","expiry":"03-Apr-2028","classes":"LF, WP"}],
            "CHEESEMANGlenn": [{"name":"Licence to Perform High Risk Work- QLD","state":"QLD","number":"0003599420 01","issueDate":"17-Oct-2025","expiry":"17-Oct-2030","classes":"LF"}],
            "COURTWOODWilliam": [{"name":"SafeWork NSW National Licence to Perform High Risk Work","state":"NSW","number":"HRW822681","issueDate":"15-Feb-2019","expiry":"15-Feb-2029","classes":"LF"}],
            "CUMPSTYAdam": [{"name":"WorkSafe Licence to Perform High Risk Work- WA","state":"WA","number":"WL610910","issueDate":"21-Apr-2025","expiry":"21-Apr-2030","classes":"LF LO WP"},{"name":"WorkSafe Accredited Assessor- WA","state":"WA","number":"4045","issueDate":"","expiry":"17-Nov-2027","classes":""}],
            "EDWARDFORDTrinden": [{"name":"WorkSafe WA Licence to Perform High Risk Work","state":"WA","number":"WL921507","issueDate":"01-Sep-2025","expiry":"01-Sep-2030","classes":"CV, LF"}],
            "FRASERDavid": [{"name":"SafeWork NSW National Licence to Perform High Risk Work","state":"NSW","number":"HRW798905","issueDate":"04-Jun-2018","expiry":"04-Jun-2028","classes":"LF, WP, C2, DG, HP"}],
            "HALLAndrew": [{"name":"WorkSafe Licence to Perform High Risk Work","state":"VIC","number":"01510562744 01","issueDate":"21-Dec-2022","expiry":"21-Dec-2027","classes":"LF"}],
            "HAMMONDSDarby": [{"name":"SafeWork NSW National Licence to Perform High Risk Work","state":"NSW","number":"HRW282718","issueDate":"30-Apr-2010","expiry":"30-Apr-2030","classes":"DG, LF, WP"}],
            "JAMIESONKerily": [{"name":"Licence to Perform High Risk Work- TAS","state":"TAS","number":"677492","issueDate":"20-Jun-2023","expiry":"20-Jun-2028","classes":"LF, LO"},{"name":"High Risk Work Accredited Assessor","state":"TAS","number":"T1950","issueDate":"05-Feb-2025","expiry":"05-Feb-2028","classes":"LF, LO"}],
            "JOSEPHDavid": [{"name":"HRW Accredited Assessor- QLD","state":"QLD","number":"31195","issueDate":"29-Apr-2025","expiry":"29-Apr-2028","classes":"LF, WP"},{"name":"SafeWork NSW National Licence to Perform High Risk Work","state":"NSW","number":"HRW295493","issueDate":"10-Feb-2011","expiry":"10-Feb-2026","classes":"LF WP"},{"name":"SafeWork NSW Acccredited Assessor High Risk Work","state":"NSW","number":"HN11085","issueDate":"10-Jun-2014","expiry":"09-Jun-2026","classes":"WP LF"}],
            "LOOMBADevjit": [{"name":"Licence to Perform High Risk Work- Qld","state":"QLD","number":"0003557330 01","issueDate":"19-Jul-2024","expiry":"19-Jul-2029","classes":"LF"}],
            "MAKSIMOVICMiler": [{"name":"WorkSafe Licence to Perform High Risk Work","state":"VIC","number":"0150078166 09","issueDate":"25-Mar-2024","expiry":"24-Mar-2029","classes":"LF, WP"}],
            "MCIVERAnthony": [{"name":"Licence to Perform High Risk Work - SA","state":"SA","number":"638287","issueDate":"24-Feb-2022","expiry":"23-Feb-2027","classes":"LF"}],
            "SHRUTTSHOTTON": [{"name":"SafeWork NSW National Licence to Perform High Risk Work","state":"NSW","number":"HRW105137","issueDate":"09-Sep-2008","expiry":"09-Sep-2028","classes":"LF, LO, WP"}],
            "VIEIRARenan": [{"name":"SafeWork NSW National Licence to Perform High Risk Work","state":"NSW","number":"HRW865659","issueDate":"02-Jul-2020","expiry":"03-Jul-2030","classes":"DG, LF, RB, WP"}],
            "WILSONMelvin": [{"name":"WorkSafe Licence to Perform High Risk Work","state":"VIC","number":"0150594737 01","issueDate":"26-Oct-2023","expiry":"25-Oct-2028","classes":"LF"}]
        };

        const driversData = {
            "ADAMDavid": {"state":"NSW","number":"8781AL","expiry":"30-Nov-2025","class":"MC, R"},
            "ALDREDTrevor": {"state":"QLD","number":"4163XU","expiry":"10-Nov-2029","class":"C, R"},
            "BEECHINGRoss": {"state":"NSW","number":"13752249","expiry":"15-Oct-2027","class":"HR, R"},
            "CHEESEMANGlenn": {"state":"QLD","number":"038 506 193","expiry":"25-Oct-2029","class":"MC, R"},
            "COURTWOODWilliam": {"state":"NSW","number":"22154412","expiry":"11-May-2030","class":"C"},
            "CUMPSTYAdam": {"state":"WA","number":"4242653","expiry":"20-Sep-2026","class":"C"},
            "EDWARDFORDTrinden": {"state":"WA","number":"4579804","expiry":"20-Feb-2026","class":"HR, R-E"},
            "FRASERDavid": {"state":"NSW","number":"5748CL","expiry":"09-Jun-2028","class":"C, R"},
            "HALLAndrew": {"state":"VIC","number":"041331530","expiry":"13-Oct-2026","class":"R, C, HR"},
            "HAMMONDSDarby": {"state":"NSW","number":"15496245","expiry":"22-Mar-2026","class":"MR, R"},
            "JAMIESONKerily": {"state":"TAS","number":"V29618","expiry":"03-Nov-2025","class":"C"},
            "JOSEPHDavid": {"state":"NSW","number":"5322FL","expiry":"02-Feb-2029","class":"C, R"},
            "LOOMBADevjit": {"state":"QLD","number":"148 542 132","expiry":"07-Feb-2028","class":"C"},
            "MAKSIMOVICMiler": {"state":"VIC","number":"053734530","expiry":"17-Oct-2028","class":"HC, C R"},
            "MCIVERAnthony": {"state":"SA","number":"C21134","expiry":"23-Feb-2030","class":"MC"},
            "SHRUTTSHOTTON": {"state":"QLD","number":"110181169","expiry":"25-Oct-2026","class":"HR, R"},
            "VIEIRARenan": {"state":"NSW","number":"5729702","expiry":"30-May-2027","class":"C"},
            "WILSONMelvin": {"state":"VIC","number":"051816850","expiry":"05-Oct-2026","class":"C"}
        };

        const githubConfig = {
            owner: 'JudyIrmisch',
            repo: 'Dashboard--ATLAS-Workforce',
            branch: 'main',
            token: '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',
            dataFile: 'workforce-data.json'
        };

        const cardsData = {
            "EDWARDFORDTrinden": [{"issuedBy":"Working with children Check","state":"WA","number":"3323185","issueDate":"","expiry":"26-Oct-2025","classes":""}],
            "MCIVERAnthony": [{"issuedBy":"Driving Instructor -SA","state":"SA","number":"C21134","issueDate":"","expiry":"03-Jul-2030","classes":""}],
            "HAMMONDSDarby": [{"issuedBy":"Focus on Safety Pty Ltd","state":"NSW","number":"5715043","issueDate":"06-Dec-2019","expiry":"06-Dec-2025","classes":"RIIWHS204D Work Safely at Heights"},{"issuedBy":"SafeWork NSW General Construction Induction","state":"NSW","number":"CGI2041348SEQ01","issueDate":"23-Aug-2024","expiry":"23-Aug-2026","classes":""}],
            "WILSONMelvin": [{"issuedBy":"Working With Children Check","state":"VIC","number":"0478700A-003","issueDate":"","expiry":"28-Aug-2030","classes":""},{"issuedBy":"Woolworth Group","state":"NSW","number":"004 532 778","issueDate":"","expiry":"24-Oct-2025","classes":"Contractor Safety Card"}],
            "JAMIESONKerily": [{"issuedBy":"Working With Vulnerable People","state":"TAS","number":"792418915","issueDate":"","expiry":"14-Sep-2026","classes":"EmployeeVolunteer"}],
            "CUMPSTYAdam": [{"issuedBy":"Working With Children Check","state":"WA","number":"2238809","issueDate":"","expiry":"18-Jul-2028","classes":""}],
            "JOSEPHDavid": [{"issuedBy":"Working With Children Check","state":"NSW","number":"WWC2323187E","issueDate":"","expiry":"15-Jun-2026","classes":"Employee"}]
        };

        const formsData = {
            "ADAMDavid": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"06-Oct-2025"},{"formCode":"Police Check","signedDate":"15-Oct-2025"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "ALDREDTrevor": [{"formCode":"Police Check","signedDate":"09-Feb-2016"},{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"06-Oct-2025"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"09-Nov-2025"}],
            "BEECHINGRoss": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"29-Oct-2025"},{"formCode":"Police Check","signedDate":"31-Oct-2025"},{"formCode":"FRM3007 Third Party Agreement","signedDate":""},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "CHEESEMANGlenn": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"16-Oct-2025"},{"formCode":"Police Check","signedDate":"20-Oct-2025"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "COURTWOODWilliam": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"06-Oct-2025"},{"formCode":"Police Check","signedDate":"12-Oct-2025"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "CUMPSTYAdam": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"05-Oct-2025"},{"formCode":"Police Check","signedDate":"09-Oct-2025"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "EDWARDFORDTrinden": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"04-Nov-2025"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "FRASERDavid": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"15-Oct-2025"},{"formCode":"Police Check","signedDate":"17-Oct-2025"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "HALLAndrew": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"15-Oct-2025"},{"formCode":"Police Check","signedDate":"17-Oct-2025"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "HAMMONDSDarby": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"04-Aug-2024"},{"formCode":"Police Check","signedDate":"05-Aug-2024"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "JAMIESONKerily": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"14-Oct-2025"},{"formCode":"Police Check","signedDate":"15-Oct-2025"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "JOSEPHDavid": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"17-Oct-2025"},{"formCode":"Police Check","signedDate":"18-Oct-2025"},{"formCode":"FRM3007 Third Party Agreement","signedDate":""},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "LOOMBADevjit": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"08-Oct-2025"},{"formCode":"Police Check","signedDate":"10-Oct-2025"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "MAKSIMOVICMiler": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"07-Oct-2025"},{"formCode":"Police Check","signedDate":"09-Oct-2025"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "MCIVERAnthony": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"02-May-2025"},{"formCode":"FRM201B Fit and Proper Declaration Addendum","signedDate":"02-May-2025"},{"formCode":"Police Check","signedDate":"06-May-2025"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "SHRUTTSHOTTON": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"04-Oct-2025"},{"formCode":"Police Check","signedDate":"08-Oct-2025"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "VIEIRARenan": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"11-Oct-2025"},{"formCode":"Police Check","signedDate":"13-Oct-2025"},{"formCode":"FRM3007 Third Party Agreement","signedDate":""},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}],
            "WILSONMelvin": [{"formCode":"FRM201A Fit and Proper Declaration","signedDate":"21-Feb-2024"},{"formCode":"Police Check","signedDate":"23-Feb-2024"},{"formCode":"FRM3004 Confidentiality and Non Disclosure","signedDate":"10-Nov-2025"}]
        };

        const diplomasData = {
            "EDWARDFORDTrinden": [{"qualification":"TLI50415 Diploma of Logistics","completionDate":"28-Sep-2017","type":"Diploma"}],
            "VIEIRARenan": [{"qualification":"BSB60407 Advanced Diploma of Management","completionDate":"14-Dec-2010","type":"Diploma"}]
        };

        const certificatesData = {
            "ADAMDavid": [{"qualification":"TAE40110 Certificate IV in Training and Assessment","completionDate":"01-Jun-2011","type":"Certificate"}],
            "BEECHINGRoss": [{"qualification":"TAE40116 Certificate IV in Training and Assessment","completionDate":"05-Feb-2022","type":"Certificate"}],
            "CHEESEMANGlenn": [{"qualification":"TAE40110 Certificate IV in Training and Assessment","completionDate":"04-Feb-2014","type":"Certificate"}],
            "COURTWOODWilliam": [{"qualification":"TAE40116 Certificate IV in Training and Assessment","completionDate":"19-Aug-2021","type":"Certificate"}],
            "CUMPSTYAdam": [{"qualification":"TAE40110 Certificate IV in Training and Assessment","completionDate":"25-Feb-2014","type":"Certificate"},{"qualification":"TLI41810 Certificate IV (Warehousing Operations)","completionDate":"08-Nov-2013","type":"Certificate"}],
            "EDWARDFORDTrinden": [{"qualification":"TLI50415 Diploma of Logistics","completionDate":"28-Sep-2017","type":"Certificate"}],
            "FRASERDavid": [{"qualification":"TAE40110 Certificate IV in Training and Assessment","completionDate":"10-Oct-2015","type":"Certificate"}],
            "HALLAndrew": [{"qualification":"TAE40110 Certificate IV in Training and Assessment","completionDate":"19-Oct-2011","type":"Certificate"}],
            "HAMMONDSDarby": [{"qualification":"AUR31216 Certifficate III in Mobile Plant Technology","completionDate":"18-Sep-2018","type":"Certificate"},{"qualification":"TAE40116 Certificate IV in Training and Assessment","completionDate":"27-Jun-2023","type":"Certificate"}],
            "JAMIESONKerily": [{"qualification":"TAE40110 Certificate IV in Training and Assessment","completionDate":"05-Mar-2012","type":"Certificate"},{"qualification":"TAE40116 Certificate IV in Training and Assessment","completionDate":"24-Apr-2020","type":"Certificate"}],
            "JOSEPHDavid": [{"qualification":"TAE40116 Certificate IV in Training and Assessment","completionDate":"19-Nov-2018","type":"Certificate"}],
            "MAKSIMOVICMiler": [{"qualification":"TAE40116 Certificate IV in Training and Assessment","completionDate":"19-Jul-2019","type":"Certificate"}],
            "MCIVERAnthony": [{"qualification":"TAE40110 Certificate IV in Training and Assessment","completionDate":"03-Nov-2011","type":"Certificate"}],
            "SHRUTTSHOTTON": [{"qualification":"TAE40116 Certificate IV in Training and Assessment","completionDate":"18-Jun-2012","type":"Certificate"}],
            "VIEIRARenan": [{"qualification":"TAE40116 Certificate IV in Training and Assessment","completionDate":"09-Feb-2018","type":"Certificate"}],
            "WILSONMelvin": [{"qualification":"TAE40116 Certificate IV in Training and Assessment","completionDate":"25-Mar-2019","type":"Certificate"}]
        };

        const userCredentials = {
            user: { password: 'stacy2025', name: 'User - Stacy' },
            admin: { password: 'judy2025', name: 'Administrator - Judy' }
        };

        let currentUser = null;
        let isLoading = false;
        let githubFailed = false;
        let saveTimer = null;
        let staffKeys = [];
        let currentIndex = 0;
        let changeLog = [];
        let editingElement = null;

        function parseDate(dateStr) {
            if (!dateStr || dateStr === "No data available" || dateStr === "") return null;
            const parts = dateStr.split('-');
            if (parts.length !== 3) return null;
            const months = {"Jan":0,"Feb":1,"Mar":2,"Apr":3,"May":4,"Jun":5,"Jul":6,"Aug":7,"Sep":8,"Oct":9,"Nov":10,"Dec":11};
            const day = parseInt(parts[0]);
            const month = months[parts[1]];
            const year = parseInt(parts[2]);
            if (isNaN(day) || month === undefined || isNaN(year)) return null;
            return new Date(year, month, day);
        }

        function getDateStatus(expiryDate) {
            if (!expiryDate) return 'unknown';
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const expiry = parseDate(expiryDate);
            if (!expiry) return 'unknown';
            if (expiry < today) return 'expired';
            if (expiry.getFullYear() === 2025 && expiry.getMonth() === 10) return 'this-month';
            const thirtyDaysFromNow = new Date(today);
            thirtyDaysFromNow.setDate(today.getDate() + 30);
            if (expiry <= thirtyDaysFromNow) return 'soon';
            return 'valid';
        }

        function getDaysDifference(expiryDate) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const expiry = parseDate(expiryDate);
            if (!expiry) return null;
            const diff = Math.floor((expiry - today) / (1000 * 60 * 60 * 24));
            return diff;
        }

        window.onload = function() {
            console.log('üöÄ Dashboard starting...');
            loadGitHubData(); // This will call populateStaffDropdown
        };

        function loadGitHubData() {
            // Prevent multiple simultaneous loads
            if (isLoading) {
                console.log('Already loading data...');
                return;
            }

            isLoading = true;

            // Try localStorage first
            try {
                const backup = localStorage.getItem('atlasWorkforceBackup');
                if (backup) {
                    const content = JSON.parse(backup);
                    if (content.staffData) {
                        Object.assign(staffData, content.staffData);
                        console.log('‚úÖ Loaded from localStorage');
                    }
                    if (content.changeLog) changeLog = content.changeLog;
                    populateStaffDropdown();
                }
            } catch (e) {
                console.log('No localStorage backup found');
            }

            // Try GitHub once, then give up if it fails
            if (githubFailed) {
                console.log('GitHub previously failed, using local data only');
                isLoading = false;
                if (!localStorage.getItem('atlasWorkforceBackup')) {
                    populateStaffDropdown();
                }
                return;
            }

            const url = `https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}/contents/${githubConfig.dataFile}?ref=${githubConfig.branch}`;
            fetch(url, {
                headers: {
                    'Authorization': `token ${githubConfig.token}`,
                    'Accept': 'application/vnd.github.v3+json'
                }
            })
            .then(response => {
                if (response.ok) return response.json();
                throw new Error('GitHub responded with status ' + response.status);
            })
            .then(data => {
                const content = JSON.parse(atob(data.content));
                if (content.staffData) Object.assign(staffData, content.staffData);
                if (content.changeLog) changeLog = content.changeLog;
                console.log('‚úÖ Loaded from GitHub successfully');
                populateStaffDropdown();
                // Update localStorage
                localStorage.setItem('atlasWorkforceBackup', JSON.stringify(content));
                isLoading = false;
            })
            .catch(error => {
                console.log('‚ö†Ô∏è GitHub load failed: ' + error.message);
                console.log('Using local data instead');
                githubFailed = true; // Don't try again
                isLoading = false;
                if (!localStorage.getItem('atlasWorkforceBackup')) {
                    populateStaffDropdown();
                }
            });
        }

        function saveToGitHub() {
            // Always save to localStorage first
            try {
                const dataToSave = {
                    staffData: staffData,
                    changeLog: changeLog,
                    lastUpdated: new Date().toISOString()
                };
                localStorage.setItem('atlasWorkforceBackup', JSON.stringify(dataToSave));
                console.log('‚úÖ Saved to localStorage');
            } catch (e) {
                console.error('localStorage save failed:', e);
                alert('Warning: Could not save to browser storage!');
                return;
            }

            // Skip GitHub if it previously failed
            if (githubFailed) {
                console.log('‚ö†Ô∏è GitHub disabled (using localStorage only)');
                return;
            }

            // Try GitHub save
            const dataToSave = {
                staffData: staffData,
                changeLog: changeLog,
                lastUpdated: new Date().toISOString()
            };
            const url = `https://api.github.com/repos/${githubConfig.owner}/${githubConfig.repo}/contents/${githubConfig.dataFile}`;

            fetch(url, {
                headers: {
                    'Authorization': `token ${githubConfig.token}`,
                    'Accept': 'application/vnd.github.v3+json'
                }
            })
            .then(response => response.ok ? response.json() : null)
            .then(existingFile => {
                const content = btoa(JSON.stringify(dataToSave, null, 2));
                const payload = {
                    message: `Update workforce data - ${new Date().toLocaleString('en-AU')}`,
                    content: content,
                    branch: githubConfig.branch
                };
                if (existingFile && existingFile.sha) payload.sha = existingFile.sha;
                return fetch(url, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${githubConfig.token}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
            })
            .then(response => {
                if (response && response.ok) {
                    console.log('‚úÖ Also saved to GitHub!');
                    return response.json();
                } else {
                    throw new Error('GitHub save failed');
                }
            })
            .catch(error => {
                console.log('‚ö†Ô∏è GitHub save failed - data is safe in localStorage');
                githubFailed = true; // Stop trying GitHub
            });
        }

        function logChange(action, details) {
            const timestamp = new Date().toLocaleString('en-AU', { day: '2-digit', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' });
            changeLog.unshift({
                timestamp: timestamp,
                user: currentUser ? currentUser.name : 'Unknown',
                action: action,
                details: details
            });
        }

        function showLoginModal() {
            const modal = document.getElementById('loginModal');
            if (!modal) {
                console.error('Login modal not found');
                return;
            }

            // Prevent opening if already open
            if (modal.classList.contains('active')) {
                return;
            }

            modal.classList.add('active');

            // Reset form safely
            const role = document.getElementById('userRole');
            const pwd = document.getElementById('userPassword');
            const pwdGroup = document.getElementById('passwordGroup');
            const err = document.getElementById('errorMsg');

            if (role) role.value = '';
            if (pwd) pwd.value = '';
            if (pwdGroup) pwdGroup.style.display = 'none';
            if (err) err.style.display = 'none';
        }

        function hideLoginModal() {
            const modal = document.getElementById('loginModal');
            if (!modal) return;

            modal.classList.remove('active');

            // Reset form safely
            const role = document.getElementById('userRole');
            const pwd = document.getElementById('userPassword');
            const pwdGroup = document.getElementById('passwordGroup');
            const err = document.getElementById('errorMsg');

            if (role) role.value = '';
            if (pwd) pwd.value = '';
            if (pwdGroup) pwdGroup.style.display = 'none';
            if (err) err.style.display = 'none';
        }

        function togglePasswordField() {
            const role = document.getElementById('userRole').value;
            const passwordGroup = document.getElementById('passwordGroup');
            if (role === 'readonly') {
                passwordGroup.style.display = 'none';
            } else if (role) {
                passwordGroup.style.display = 'block';
            } else {
                passwordGroup.style.display = 'none';
            }
            document.getElementById('errorMsg').style.display = 'none';
        }

        function handleLogin() {
            const role = document.getElementById('userRole').value;
            const password = document.getElementById('userPassword').value;
            const errorMsg = document.getElementById('errorMsg');

            if (!role) {
                errorMsg.textContent = 'Please select a role.';
                errorMsg.style.display = 'block';
                return;
            }

            if (role === 'readonly') {
                currentUser = { role: 'readonly', name: 'Read-Only User' };
                updateLoginDisplay();
                hideLoginModal();
                return;
            }

            if (userCredentials[role] && userCredentials[role].password === password) {
                currentUser = { role: role, name: userCredentials[role].name };
                updateLoginDisplay();
                hideLoginModal();
                logChange('User Login', `${currentUser.name} logged in`);
            } else {
                errorMsg.style.display = 'block';
            }
        }

        function updateLoginDisplay() {
            const loginCorner = document.getElementById('loginCorner');
            const actionButtons = document.getElementById('actionButtons');
            const editHint = document.getElementById('editHint');

            if (currentUser) {
                loginCorner.innerHTML = `<div class="user-info"><strong>${currentUser.name}</strong> <button class="logout-btn" onclick="logout()">Logout</button></div>`;
                if (currentUser.role !== 'readonly') {
                    actionButtons.style.display = 'flex';
                    editHint.style.display = 'block';
                    enableEditing();
                    if (currentIndex >= 0) {
                        document.getElementById('deleteBtn').style.display = 'inline-block';
                    }
                }
            } else {
                loginCorner.innerHTML = '<button class="login-btn" onclick="showLoginModal()">üîê Login</button>';
                actionButtons.style.display = 'none';
                editHint.style.display = 'none';
                document.getElementById('deleteBtn').style.display = 'none';
                disableEditing();
            }
        }

        function logout() {
            logChange('User Logout', `${currentUser.name} logged out`);
            currentUser = null;
            updateLoginDisplay();
        }

        function enableEditing() {
            const editables = document.querySelectorAll('.editable');
            editables.forEach(el => {
                el.style.cursor = 'pointer';
                el.onclick = function(e) {
                    if (!editingElement && currentUser && currentUser.role !== 'readonly') {
                        startEdit(this);
                    }
                };
            });
        }

        function disableEditing() {
            const editables = document.querySelectorAll('.editable');
            editables.forEach(el => {
                el.style.cursor = 'default';
                el.onclick = null;
            });
        }

        function startEdit(element) {
            editingElement = element;
            const currentValue = element.textContent;
            const field = element.dataset.field;
            element.classList.add('editing');

            if (field === 'teamStatus' || field === 'typeOfWorkforce' || field === 'state') {
                const select = document.createElement('select');
                select.className = 'edit-input';
                let options = [];
                if (field === 'teamStatus') options = ['Active', 'Inactive', 'In Progress', 'Pending'];
                else if (field === 'typeOfWorkforce') options = ['Contractor', 'Staff', 'Casual Employee', 'Pending'];
                else if (field === 'state') options = ['NSW', 'VIC', 'QLD', 'SA', 'WA', 'TAS', 'NT', 'ACT', 'NA'];

                options.forEach(opt => {
                    const option = document.createElement('option');
                    option.value = opt;
                    option.textContent = opt;
                    if (opt === currentValue) option.selected = true;
                    select.appendChild(option);
                });

                element.textContent = '';
                element.appendChild(select);
                select.focus();
                select.onchange = () => saveEdit(element, select.value, currentValue);
                select.onblur = () => cancelEdit(element, currentValue);
            } else {
                const input = document.createElement('input');
                input.type = 'text';
                input.className = 'edit-input';
                input.value = currentValue;
                element.textContent = '';
                element.appendChild(input);
                input.focus();
                input.select();

                input.onkeydown = (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        saveEdit(element, input.value, currentValue);
                    } else if (e.key === 'Escape') {
                        cancelEdit(element, currentValue);
                    }
                };

                input.onblur = () => {
                    setTimeout(() => {
                        if (editingElement === element) {
                            cancelEdit(element, currentValue);
                        }
                    }, 200);
                };
            }
        }

        function saveEdit(element, newValue, oldValue) {
            if (newValue === oldValue) {
                cancelEdit(element, oldValue);
                return;
            }

            const staffId = staffKeys[currentIndex];
            const field = element.dataset.field;
            const section = element.dataset.section || 'basic';
            const index = element.dataset.index;
            if (section === 'basic') {
                staffData[staffId][field] = newValue;
            } else if (section === 'police') {
                if (!staffData[staffId].police) staffData[staffId].police = {};
                staffData[staffId].police[field] = newValue;
            } else if (section === 'insurance') {
                if (!staffData[staffId].insurance) staffData[staffId].insurance = {};
                staffData[staffId].insurance[field] = newValue;
            } else if (section === 'hrw') {
                if (!staffData[staffId].hrwLicences) staffData[staffId].hrwLicences = [];
                const idx = parseInt(index) || 0;
                if (!staffData[staffId].hrwLicences[idx]) staffData[staffId].hrwLicences[idx] = {};
                staffData[staffId].hrwLicences[idx][field] = newValue;
            } else if (section === 'drivers') {
                if (!staffData[staffId].drivers) staffData[staffId].drivers = {};
                staffData[staffId].drivers[field] = newValue;
            } else if (section === 'cards') {
                if (!staffData[staffId].cardsData) staffData[staffId].cardsData = [];
                const idx = parseInt(index) || 0;
                if (!staffData[staffId].cardsData[idx]) staffData[staffId].cardsData[idx] = {};
                staffData[staffId].cardsData[idx][field] = newValue;
            } else if (section === 'forms') {
                if (!staffData[staffId].formsData) staffData[staffId].formsData = [];
                const idx = parseInt(index) || 0;
                if (!staffData[staffId].formsData[idx]) staffData[staffId].formsData[idx] = {};
                staffData[staffId].formsData[idx][field] = newValue;
            } else if (section === 'diplomas') {
                if (!staffData[staffId].diplomasData) staffData[staffId].diplomasData = [];
                const idx = parseInt(index) || 0;
                if (!staffData[staffId].diplomasData[idx]) staffData[staffId].diplomasData[idx] = {};
                staffData[staffId].diplomasData[idx][field] = newValue;
            } else if (section === 'certificates') {
                if (!staffData[staffId].certificatesData) staffData[staffId].certificatesData = [];
                const idx = parseInt(index) || 0;
                if (!staffData[staffId].certificatesData[idx]) staffData[staffId].certificatesData[idx] = {};
                staffData[staffId].certificatesData[idx][field] = newValue;
            }
            element.textContent = newValue;
            element.classList.remove('editing');
            editingElement = null;
            logChange('Field Updated', `${staffData[staffId].firstName} ${staffData[staffId].surname} - ${field}: ${oldValue} ‚Üí ${newValue}`);

            // Debounced save
            if (saveTimer) clearTimeout(saveTimer);
            saveTimer = setTimeout(() => {
                saveToGitHub();
            }, 1000);
        }

        function cancelEdit(element, originalValue) {
            element.textContent = originalValue;
            element.classList.remove('editing');
            editingElement = null;
        }

        function populateStaffDropdown() {
            const select = document.getElementById('staffSelect');
            select.innerHTML = '<option value="">-- Select --</option>';
            
            // Create array of staff with their data for sorting
            const staffArray = Object.keys(staffData).map(key => ({
                key: key,
                data: staffData[key],
                sortName: `${staffData[key].surname}, ${staffData[key].firstName}`
            }));
            
            // Sort alphabetically by "Surname, FirstName"
            staffArray.sort((a, b) => a.sortName.localeCompare(b.sortName));
            
            // Update staffKeys with sorted order
            staffKeys = staffArray.map(item => item.key);

            staffKeys.forEach((key, index) => {
                const staff = staffData[key];
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${staff.surname}, ${staff.firstName} (${staff.atlasId})`;
                select.appendChild(option);
            });
        }

        function loadStaffData() {
            const select = document.getElementById('staffSelect');
            currentIndex = parseInt(select.value);
            if (isNaN(currentIndex) || currentIndex < 0) {
                currentIndex = -1;
                document.getElementById('staffDetails').innerHTML = '';
                document.getElementById('staffInfo').style.display = 'none';
                return;
            }
            displayStaffDetails();
        }

        function previousStaff() {
            if (currentIndex > 0) {
                currentIndex--;
                document.getElementById('staffSelect').value = currentIndex;
                displayStaffDetails();
            }
        }

        function nextStaff() {
            if (currentIndex < staffKeys.length - 1) {
                currentIndex++;
                document.getElementById('staffSelect').value = currentIndex;
                displayStaffDetails();
            }
        }

        function displayStaffDetails() {
            if (currentIndex < 0 || currentIndex >= staffKeys.length) return;

            const staffId = staffKeys[currentIndex];
            const staff = staffData[staffId];
            const police = policeData[staffId] || {};
            const insurance = insuranceData[staffId] || {};
            const hrw = hrwData[staffId] || [];
            const driver = driversData[staffId] || {};

            document.getElementById('staffInfo').style.display = 'block';
            document.getElementById('currentStaffName').textContent = `${staff.firstName} ${staff.surname}`;

            if (currentUser && currentUser.role !== 'readonly') {
                document.getElementById('deleteBtn').style.display = 'inline-block';
            }

            let html = `
                <div class="staff-section">
                    <div class="staff-name">${staff.firstName} ${staff.middleName} ${staff.surname} <span class="atlas-id">(${staff.atlasId})</span></div>
                    <div class="contact-groups">
                        <div class="contact-group">
                            <div class="contact-group-title">1Ô∏è‚É£ üìã Basic Information</div>
                            <div class="contact-item">
                                <div class="contact-label">Type of Workforce</div>
                                <div class="contact-value editable" data-field="typeOfWorkforce">${staff.typeOfWorkforce || 'No data available'}</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-label">State</div>
                                <div class="contact-value editable" data-field="state">${staff.state || 'No data available'}</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-label">Team Status</div>
                                <div class="contact-value editable" data-field="teamStatus">${staff.teamStatus || 'No data available'}</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-label">Date of Birth</div>
                                <div class="contact-value editable" data-field="dateOfBirth">${staff.dateOfBirth || 'No data available'}</div>
                            </div>
                        </div>
                        <div class="contact-group">
                            <div class="contact-group-title">üìû Contact Details</div>
                            <div class="contact-item">
                                <div class="contact-label">Mobile Number</div>
                                <div class="contact-value editable" data-field="mobileNumber">${staff.mobileNumber || 'No data available'}</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-label">Email</div>
                                <div class="contact-value editable" data-field="email">${staff.email || 'No data available'}</div>
                            </div>
                        </div>
                        <div class="contact-group">
                            <div class="contact-group-title">üìç Address</div>
                            <div class="contact-item">
                                <div class="contact-label">Address</div>
                                <div class="contact-value editable" data-field="address">${staff.address || 'No data available'}</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-label">Suburb</div>
                                <div class="contact-value editable" data-field="suburb">${staff.suburb || 'No data available'}</div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-label">Postcode</div>
                                <div class="contact-value editable" data-field="postcode">${staff.postcode || 'No data available'}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Police Check
            html += `<div class="staff-section">
                <div class="section-header">2Ô∏è‚É£ üëÆ Police Check</div>`;
            if (police.checkDate) {
                html += `<table>
                    <tr><th>Check Date</th><th>Expiry</th><th>Result</th></tr>
                    <tr>
                        <td><span class="editable" data-section="police" data-field="checkDate">${police.checkDate}</span></td>
                        <td><span class="editable" data-section="police" data-field="expiry">${police.expiry}</span></td>
                        <td><span class="editable" data-section="police" data-field="result">${police.result}</span>${police.comments ? '<br><small class="editable" data-section="police" data-field="comments">' + police.comments + '</small>' : ''}</td>
                    </tr>
                </table>`;
            } else {
                html += `<div class="empty-section">No police check data available</div>`;
            }
            html += `</div>`;

            // Insurance
            html += `<div class="staff-section">
                <div class="section-header">3Ô∏è‚É£ üìÑ Insurance (Professional Indemnity & Public Liability)</div>`;
            if (insurance.indemnity || insurance.liability) {
                html += `<table>
                    <tr><th>Type</th><th>Status</th><th>Start Date</th><th>Expiry</th><th>Policy Number</th></tr>`;
                if (insurance.indemnity && insurance.indemnity !== 'Casual Employee' && insurance.indemnity !== 'Staff') {
                    html += `<tr>
                        <td>Professional Indemnity</td>
                        <td>${insurance.indemnity}</td>
                        <td>${insurance.indemnityStart || '-'}</td>
                        <td>${insurance.indemnityExpiry || '-'}</td>
                        <td>${insurance.indemnityPolicy || '-'}</td>
                    </tr>`;
                } else if (insurance.indemnity) {
                    html += `<tr><td colspan="5">Professional Indemnity: ${insurance.indemnity}</td></tr>`;
                }
                if (insurance.liability && insurance.liability !== 'Casual Employee' && insurance.liability !== 'Staff') {
                    html += `<tr>
                        <td>Public Liability</td>
                        <td>${insurance.liability}</td>
                        <td>${insurance.liabilityStart || '-'}</td>
                        <td>${insurance.liabilityExpiry || '-'}</td>
                        <td>${insurance.liabilityPolicy || '-'}</td>
                    </tr>`;
                } else if (insurance.liability) {
                    html += `<tr><td colspan="5">Public Liability: ${insurance.liability}</td></tr>`;
                }
                html += `</table>`;
            } else {
                html += `<div class="empty-section">No insurance data available</div>`;
            }
            html += `</div>`;

            // HRW Licences
            html += `<div class="staff-section">
                <div class="section-header">4Ô∏è‚É£ üèóÔ∏è High Risk Work Licence</div>`;
            if (hrw.length > 0) {
                html += `<table>
                    <tr><th>Licence Name</th><th>State</th><th>Number</th><th>Issue Date</th><th>Expiry</th><th>Classes</th></tr>`;
                hrw.forEach(licence => {
                    html += `<tr>
                        <td>${licence.name}</td>
                        <td>${licence.state}</td>
                        <td>${licence.number}</td>
                        <td>${licence.issueDate || '-'}</td>
                        <td>${licence.expiry || '-'}</td>
                        <td>${licence.classes || '-'}</td>
                    </tr>`;
                });
                html += `</table>`;
            } else {
                html += `<div class="empty-section">No HRW licence data available</div>`;
            }
            html += `</div>`;

            // Driver's Licence
            html += `<div class="staff-section">
                <div class="section-header">5Ô∏è‚É£ üöó Driver's Licence</div>`;
            if (driver.state) {
                html += `<table>
                    <tr><th>State</th><th>Number</th><th>Expiry</th><th>Class</th></tr>
                    <tr>
                        <td><span class="editable" data-section="drivers" data-field="state">${driver.state}</span></td>
                        <td><span class="editable" data-section="drivers" data-field="number">${driver.number}</span></td>
                        <td><span class="editable" data-section="drivers" data-field="expiry">${driver.expiry}</span></td>
                        <td><span class="editable" data-section="drivers" data-field="class">${driver.class}</span></td>
                    </tr>
                </table>`;
            } else {
                html += `<div class="empty-section">No driver's licence data available</div>`;
            }
            html += `</div>`;

            // Cards & Licences
            const cards = cardsData[staffId] || [];
            html += `<div class="staff-section">
                <div class="section-header">6Ô∏è‚É£ üé¥ Cards & Licences</div>`;
            if (cards.length > 0) {
                html += `<table>
                    <tr><th>Issued By</th><th>State</th><th>Number</th><th>Issue Date</th><th>Expiry</th><th>Classes</th></tr>`;
                cards.forEach(card => {
                    html += `<tr>
                        <td>${card.issuedBy}</td>
                        <td>${card.state}</td>
                        <td>${card.number}</td>
                        <td>${card.issueDate || '-'}</td>
                        <td>${card.expiry}</td>
                        <td>${card.classes || '-'}</td>
                    </tr>`;
                });
                html += `</table>`;
            } else {
                html += `<div class="empty-section">No cards/licences data available</div>`;
            }
            html += `</div>`;

            // Forms
            const forms = formsData[staffId] || [];
            html += `<div class="staff-section">
                <div class="section-header">7Ô∏è‚É£ üìã Forms</div>`;
            if (forms.length > 0) {
                html += `<table>
                    <tr><th>Form Code</th><th>Signed Date</th></tr>`;
                forms.forEach(form => {
                    html += `<tr>
                        <td>${form.formCode}</td>
                        <td>${form.signedDate || 'Not Signed'}</td>
                    </tr>`;
                });
                html += `</table>`;
            } else {
                html += `<div class="empty-section">No forms data available</div>`;
            }
            html += `</div>`;

            // Education Section Header
            html += `<div class="staff-section">
                <div class="section-header">8Ô∏è‚É£ üéì Diplomas</div>`;
            
            // Diplomas
            const diplomas = diplomasData[staffId] || [];
            if (diplomas.length > 0) {
                html += `<h4 style="color: #9370db; margin: 15px 0 10px 0; font-size: 15px;">üìú Diplomas</h4>`;
                html += `<table>
                    <tr><th>Qualification</th><th>Completion Date</th><th>Type</th></tr>`;
                diplomas.forEach(dip => {
                    html += `<tr>
                        <td>${dip.qualification}</td>
                        <td>${dip.completionDate}</td>
                        <td>${dip.type}</td>
                    </tr>`;
                });
                html += `</table>`;
            }
            
            // Certificates
            const certificates = certificatesData[staffId] || [];
            if (certificates.length > 0) {
                html += `<div class="section-header">9Ô∏è‚É£ üìú Certificates</div>`;
                html += `<table>
                    <tr><th>Qualification</th><th>Completion Date</th><th>Type</th></tr>`;
                certificates.forEach(cert => {
                    html += `<tr>
                        <td>${cert.qualification}</td>
                        <td>${cert.completionDate}</td>
                        <td>${cert.type}</td>
                    </tr>`;
                });
                html += `</table>`;
            }
            
            // Statement of Attainments
            const soaList = [];
            Object.keys(soaMapping).forEach(soaName => {
                const holders = soaMapping[soaName];
                if (holders[staffId]) {
                    soaList.push({
                        soa: soaName,
                        completionDate: holders[staffId].completionDate,
                        completedBy: holders[staffId].completedBy
                    });
                }
            });
            
            if (soaList.length > 0) {
                html += `<div class="section-header">üîü üìä Statement of Attainment (${soaList.length})</div>`;
                html += `<div style="margin-bottom: 10px; padding: 10px; background-color: #e3f2fd; border-left: 4px solid #2196f3; font-size: 12px; color: #1976d2;">
                    üí° <strong>Tip:</strong> View all workforce members with specific SOAs in the <strong>üìú SOA Reports</strong> section (button above).
                </div>`;
                html += `<table>
                    <tr><th>Statement of Attainment</th><th>Completion Date</th><th>Completed By</th></tr>`;
                soaList.sort((a, b) => a.soa.localeCompare(b.soa)).forEach(item => {
                    html += `<tr>
                        <td>${item.soa}</td>
                        <td>${item.completionDate}</td>
                        <td>${item.completedBy}</td>
                    </tr>`;
                });
                html += `</table>`;
            }
            
            // If no education at all
            if (diplomas.length === 0 && certificates.length === 0 && soaList.length === 0) {
                html += `<div class="empty-section">No education/qualifications data available</div>`;
            }
            
            html += `</div>`;

            document.getElementById('staffDetails').innerHTML = html;
            if (currentUser && currentUser.role !== 'readonly') {
                enableEditing();
            }
        }

        function showAddStaffModal() {
            document.getElementById('addStaffModal').classList.add('active');
        }

        function hideAddStaffModal() {
            document.getElementById('addStaffModal').classList.remove('active');
            document.getElementById('newFirstName').value = '';
            document.getElementById('newMiddleName').value = '';
            document.getElementById('newSurname').value = '';
            document.getElementById('newDOB').value = '';
            document.getElementById('newType').value = '';
            document.getElementById('newState').value = '';
            document.getElementById('newStatus').value = '';
            document.getElementById('newMobile').value = '';
            document.getElementById('newEmail').value = '';
            document.getElementById('newAddress').value = '';
        }

        function saveNewStaff() {
            const firstName = document.getElementById('newFirstName').value.trim();
            const middleName = document.getElementById('newMiddleName').value.trim();
            const surname = document.getElementById('newSurname').value.trim();
            const dateOfBirth = document.getElementById('newDOB').value.trim();
            const typeOfWorkforce = document.getElementById('newType').value;
            const state = document.getElementById('newState').value;
            const teamStatus = document.getElementById('newStatus').value;
            const mobileNumber = document.getElementById('newMobile').value.trim();
            const email = document.getElementById('newEmail').value.trim();
            const address = document.getElementById('newAddress').value.trim();

            if (!firstName || !surname || !typeOfWorkforce || !teamStatus) {
                alert('Please fill in all required fields (marked with *)');
                return;
            }

            const atlasId = `${surname}${firstName}`;
            if (staffData[atlasId]) {
                alert('A staff member with this name already exists!');
                return;
            }

            staffData[atlasId] = {
                firstName,
                middleName,
                surname,
                atlasId,
                typeOfWorkforce,
                state: state || 'NA',
                teamStatus,
                dateOfBirth: dateOfBirth || '',
                mobileNumber: mobileNumber || '',
                email: email || '',
                address: address || 'No data available'
            };

            logChange('Workforce Added', `${firstName} ${surname} added to system`);
            populateStaffDropdown();
            hideAddStaffModal();

            const newIndex = staffKeys.indexOf(atlasId);
            if (newIndex >= 0) {
                currentIndex = newIndex;
                document.getElementById('staffSelect').value = currentIndex;
                displayStaffDetails();
                saveToGitHub();
                alert(`${firstName} ${surname} has been successfully added!`);
            }
        }

        function deleteStaff() {
            if (!currentUser || currentUser.role === 'readonly') {
                alert('You need Administrator access to delete workforce members.');
                return;
            }

            if (currentIndex < 0 || !staffKeys[currentIndex]) {
                alert('Please select a staff member first.');
                return;
            }

            const staffId = staffKeys[currentIndex];
            const staff = staffData[staffId];

            if (confirm(`Are you sure you want to delete ${staff.firstName} ${staff.surname}?`)) {
                logChange('Workforce Deleted', `${staff.firstName} ${staff.surname} removed from system`);
                delete staffData[staffId];
                populateStaffDropdown();
                currentIndex = -1;
                document.getElementById('staffSelect').value = '';
                document.getElementById('staffDetails').innerHTML = '';
                document.getElementById('staffInfo').style.display = 'none';
                document.getElementById('deleteBtn').style.display = 'none';
                saveToGitHub();
                alert(`${staff.firstName} ${staff.surname} has been deleted.`);
            }
        }

        function exportData() {
            const dataToExport = {
                staffData: staffData,
                policeData: policeData,
                insuranceData: insuranceData,
                hrwData: hrwData,
                driversData: driversData,
                changeLog: changeLog,
                exportDate: new Date().toISOString()
            };
            const json = JSON.stringify(dataToExport, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ATLAS-Backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function showImportDialog() {
            if (!currentUser || currentUser.role === 'readonly') {
                alert('You need Administrator access to import data.');
                return;
            }

            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const imported = JSON.parse(event.target.result);
                            if (imported.staffData) {
                                Object.assign(staffData, imported.staffData);
                            }
                            if (imported.changeLog) {
                                changeLog = imported.changeLog;
                            }
                            logChange('Data Imported', `Imported data from ${file.name}`);
                            populateStaffDropdown();
                            saveToGitHub();
                            alert('Data imported successfully!');
                        } catch (error) {
                            alert('Error importing file. Please ensure it\'s a valid ATLAS backup file.');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        function showChangeLogModal() {
            const modal = document.getElementById('changeLogModal');
            const content = document.getElementById('changeLogContent');
            
            if (changeLog.length === 0) {
                content.innerHTML = '<p style="text-align: center; color: #999;">No changes recorded yet.</p>';
            } else {
                let html = '';
                changeLog.forEach(entry => {
                    html += `<div class="log-entry">
                        <div class="log-timestamp">${entry.timestamp}</div>
                        <div class="log-action"><strong>${entry.user}</strong> - ${entry.action}: ${entry.details}</div>
                    </div>`;
                });
                content.innerHTML = html;
            }
            modal.classList.add('active');
        }

        function hideChangeLogModal() {
            document.getElementById('changeLogModal').classList.remove('active');
        }

        function showReportsModal() {
            document.getElementById('reportsModal').classList.add('active');
            updateReport();
        }

        function hideReportsModal() {
            document.getElementById('reportsModal').classList.remove('active');
        }

        function showStateReportsModal() {
            document.getElementById('stateReportsModal').classList.add('active');
            generateStateReport();
        }

        function hideStateReportsModal() {
            document.getElementById('stateReportsModal').classList.remove('active');
        }

        function generateStateReport() {
            const stateGroups = {};
            
            staffKeys.forEach(staffId => {
                const staff = staffData[staffId];
                const state = staff.state || 'NA';
                
                if (!stateGroups[state]) {
                    stateGroups[state] = [];
                }
                
                stateGroups[state].push({
                    name: `${staff.firstName} ${staff.surname}`,
                    type: staff.typeOfWorkforce,
                    status: staff.teamStatus,
                    mobile: staff.mobileNumber || '-',
                    email: staff.email || '-'
                });
            });

            const states = Object.keys(stateGroups).sort();
            let html = '';

            states.forEach(state => {
                const members = stateGroups[state];
                html += `
                    <div class="staff-section">
                        <div class="section-header">${state} - ${members.length} Workforce Member${members.length !== 1 ? 's' : ''}</div>
                        <table>
                            <tr>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Mobile</th>
                                <th>Email</th>
                            </tr>`;
                
                members.sort((a, b) => a.name.localeCompare(b.name)).forEach(member => {
                    html += `
                        <tr>
                            <td>${member.name}</td>
                            <td>${member.type}</td>
                            <td>${member.status}</td>
                            <td>${member.mobile}</td>
                            <td>${member.email}</td>
                        </tr>`;
                });
                
                html += `</table></div>`;
            });

            document.getElementById('stateReportContent').innerHTML = html;
        }

        function printStateReport() {
            window.print();
        }

        function exportStateReportCSV() {
            let csvContent = 'State,Name,Type,Status,Mobile,Email\n';
            
            const stateGroups = {};
            staffKeys.forEach(staffId => {
                const staff = staffData[staffId];
                const state = staff.state || 'NA';
                if (!stateGroups[state]) stateGroups[state] = [];
                stateGroups[state].push(staff);
            });

            const states = Object.keys(stateGroups).sort();
            states.forEach(state => {
                stateGroups[state].sort((a, b) => `${a.surname} ${a.firstName}`.localeCompare(`${b.surname} ${b.firstName}`));
                stateGroups[state].forEach(staff => {
                    csvContent += `"${state}","${staff.firstName} ${staff.surname}","${staff.typeOfWorkforce}","${staff.teamStatus}","${staff.mobileNumber || '-'}","${staff.email || '-'}"\n`;
                });
            });

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ATLAS-State-Report-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function showSOAReportsModal() {
            document.getElementById('soaReportsModal').classList.add('active');
            populateSOADropdown();
        }

        function hideSOAReportsModal() {
            document.getElementById('soaReportsModal').classList.remove('active');
        }

        const soaMapping = {
    "AHCMOM216 - Operate Side by Side Utility Vehicles": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "AURTGA001 - Drive and Manoeuvre Trailers": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "BSBAUD402B Participate in a quality audit": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "BSBCMM401 - Make a Presentation": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "BSBCMM401 - Make a presentation": {"JAMIESONKerily": {"completionDate":"05-Mar-2012","completedBy":"Certificate- Part of"}},
    "BSBCMM401 Make a presentation": {"MCIVERAnthony": {"completionDate":"03-Nov-2011","completedBy":"Certificate- Part of"}},
    "BSBCMM401A - Make a presentation": {"ADAMDavid": {"completionDate":"01-Jun-2011","completedBy":"Certificate- Part of"}},
    "BSBCMM401A Make A Presentation": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "BSBCMM401A Make a presentation": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "BSBHRM405 - Support the recruitment, selection and induction of staff": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "BSBINN502 - Build and sustain an innovative work environment": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "BSBLED401A Develop teams and individuals": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "BSBMGT516 - Facilitate continuous improvement": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "BSBMGT517 - Manage operational plan": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "BSBMKG413A Promote products and services": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "BSBREL402A Build client relationships and business networks": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "BSBRES401A Analyse and present research information": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "BSBRSK501 - Manage risk": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "BSBWHS501 - Ensure a safe workplace": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "CPCCCO3047a Cut and Core Concrete": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "CPCCLDG3001A - Licence to Perform Dogging": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "CPCCLRG3001A - Licence to Perform Rigging Basic Level": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "CPCCOHS2001A Apply OHS Requirements, Policies and Procedured in the Construction Indusrty": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "CPCCWHS1001 - Prepare to Work Safely in the Construction Industry": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "CPCCWHS2001 - Apply WHS Requirements, Policies and Procedures in the Construction Industry": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "CPCWHS101 Prepare to Work Safely in the Construction Industry": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "HLTAID001 - Provide Cardiopulmonary Resuscitation": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "HLTAID003 - Provide First Aid": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "HLTAID004 - Provide an Emergency First Aid Response in an Education and Care Setting": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "HLTAID009 - Provide Cardiopulmonary Resuscitation": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "HLTAID009 Provide cardiopulmonary resuscitation": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "HLTAID010 Provide basic emergency life support": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "HLTAID011 Provide First Aid": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "HLTAID012 - Provide First Aid in an Education and Care Setting": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "HLTAID014 - Provide Advanced First Aid": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "HLTPAT005 - Collect Specimens for Drugs of Abuse Testing": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "MEM11011B - Undertake Manual Handling": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "MNCG1033A Conduct Lifting Operations": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "MNCG1041A Conduct Non-Slewing Crane Operations": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "PUAFIR210 - Prevent Injury": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "PUASAR022 - Participate in a Rescue Operation": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "PUAWER005B - Operate as Part of an Emergency Control Organisation": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "PUAWER008B - Confine Small Workplace Emergencies": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "RIIHAN301D - Operate elevating work platform": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "RIIHAN307E Operate a Vehicle Loading Crane": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "RIIHAN309E - Conduct telescopic materials handler operations": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "RIIMPO318F Conduct Civil Construction Skid Steer Loader Operations": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "RIIMPO320F Conduct Civil Construction Excavator Operations": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "RIIMPO321F Conduct Civil Construction Wheeled FrontEnd Loader Operations": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "RIIRIS201D - Conduct Local Risk Control": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "RIIVEH305E - Operate and Maintain a Four Wheel Drive Vehicle": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "RIIWHS204D - Work Safely at Heights": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "RIIWHS204D Work safely at heights": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "RIIWHS204E Work safely at heights": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "TAEASS301 - Contribute to assessment": {"JAMIESONKerily": {"completionDate":"05-Mar-2012","completedBy":"Certificate- Part of"},"MCIVERAnthony": {"completionDate":"03-Nov-2011","completedBy":"Certificate- Part of"}},
    "TAEASS301 Contribute to assessment": {"BEECHINGRoss": {"completionDate":"05-Feb-2022","completedBy":"Certificate- Part of"}},
    "TAEASS301A  Contribute to assessment": {"ADAMDavid": {"completionDate":"01-Jun-2011","completedBy":"Certificate- Part of"}},
    "TAEASS301A Contribute To Assessment": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEASS301B  Contribute to Assessment": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEASS301B - Contribute to assessment": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEASS301B Contribute to assessment": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEASS401 - Plan Assessment Activities and Processes": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEASS401 - Plan assessment activities and processes": {"JAMIESONKerily": {"completionDate":"05-Mar-2012","completedBy":"Certificate- Part of"},"MCIVERAnthony": {"completionDate":"03-Nov-2011","completedBy":"Certificate- Part of"}},
    "TAEASS401 Plan assessment activities and processes": {"BEECHINGRoss": {"completionDate":"05-Feb-2022","completedBy":"Certificate- Part of"}},
    "TAEASS401A - Plan assessment activities and processes": {"ADAMDavid": {"completionDate":"01-Jun-2011","completedBy":"Certificate- Part of"}},
    "TAEASS401A Plan Assessment Activities And Processes": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEASS401A Plan assessment activities and processes": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEASS401B - Plan Assessment Activities and Processes": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEASS401B - Plan assessment activities and processes": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEASS401B Plan assessment activities and processes": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEASS402 - Assess Competence": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEASS402 - Assess competence": {"JAMIESONKerily": {"completionDate":"05-Mar-2012","completedBy":"Certificate- Part of"},"MCIVERAnthony": {"completionDate":"03-Nov-2011","completedBy":"Certificate- Part of"}},
    "TAEASS402 Assess competence": {"BEECHINGRoss": {"completionDate":"05-Feb-2022","completedBy":"Certificate- Part of"}},
    "TAEASS402A Assess Competence": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEASS402A Assess competence": {"ADAMDavid": {"completionDate":"01-Jun-2011","completedBy":"Certificate- Part of"}},
    "TAEASS402B - Assess competence": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEASS402B Assess Competence": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEASS402B Assess competence": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEASS403 - Participate in Assessment Validation": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEASS403 - Participate in assessment validation": {"JAMIESONKerily": {"completionDate":"05-Mar-2012","completedBy":"Certificate- Part of"},"MCIVERAnthony": {"completionDate":"03-Nov-2011","completedBy":"Certificate- Part of"}},
    "TAEASS403 Participate in assessment validation": {"BEECHINGRoss": {"completionDate":"05-Feb-2022","completedBy":"Certificate- Part of"}},
    "TAEASS403A Participate In Assessment Validation": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEASS403A Participate in assessment validation": {"ADAMDavid": {"completionDate":"01-Jun-2011","completedBy":"Certificate- Part of"}},
    "TAEASS403B - Participate in Assessment Validation": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEASS403B - Participate in assessment validation": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEASS403B Participate in assessment validation": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEASS502  Design and develop assessment tools": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEASS502 - Design and Develop Assessment Tools": {"JAMIESONKerily": {"completionDate":"05-Mar-2012","completedBy":"Certificate- Part of"}},
    "TAEASS502 - Design and develop assessment tools": {"MCIVERAnthony": {"completionDate":"03-Nov-2011","completedBy":"Certificate- Part of"}},
    "TAEASS502 Design and Develop Assessment Tools": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEASS502 Design and develop assessment tools": {"BEECHINGRoss": {"completionDate":"05-Feb-2022","completedBy":"Certificate- Part of"}},
    "TAEASS502A Design and develop assessment tools": {"ADAMDavid": {"completionDate":"01-Jun-2011","completedBy":"Certificate- Part of"}},
    "TAEASS502B - Design and Develop Assessment Tools": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEASS502B Design and develop assessment tools": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEDEL301 Provide work skill instruction": {"BEECHINGRoss": {"completionDate":"05-Feb-2022","completedBy":"Certificate- Part of"}},
    "TAEDEL301A - Provide work skill instruction": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEDEL301A Provide Work Skill Instruction": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEDEL301A Provide work skill instruction": {"ADAMDavid": {"completionDate":"01-Jun-2011","completedBy":"Certificate- Part of"}},
    "TAEDEL401 - Plan, Organise and Deliver Group-Based Learning": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEDEL401 - Plan, organise and deliver group-based learning": {"JAMIESONKerily": {"completionDate":"05-Mar-2012","completedBy":"Certificate- Part of"},"MCIVERAnthony": {"completionDate":"03-Nov-2011","completedBy":"Certificate- Part of"}},
    "TAEDEL401 Plan, organise and deliver group-based learning": {"BEECHINGRoss": {"completionDate":"05-Feb-2022","completedBy":"Certificate- Part of"}},
    "TAEDEL401A - Plan, organise and deliver group-based learning": {"ADAMDavid": {"completionDate":"01-Jun-2011","completedBy":"Certificate- Part of"}},
    "TAEDEL401A Plan, Organise And Deliver Group Based Learning": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEDEL401A Plan, Organise and Deliver Group-Based Learning": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEDEL401A Plan, organise and deliver group-based learning": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEDEL401A Plan, organise and delivery group-based learning": {"ADAMDavid": {"completionDate":"01-Jun-2011","completedBy":"Certificate- Part of"}},
    "TAEDEL402 - Plan, Organise and Facilitate Learning in the Workplace": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEDEL402 - Plan, organise and facilitate learning in the workplace": {"JAMIESONKerily": {"completionDate":"05-Mar-2012","completedBy":"Certificate- Part of"},"MCIVERAnthony": {"completionDate":"03-Nov-2011","completedBy":"Certificate- Part of"}},
    "TAEDEL402 Plan, organise and facilitate learning in the workplace": {"BEECHINGRoss": {"completionDate":"05-Feb-2022","completedBy":"Certificate- Part of"}},
    "TAEDEL402A  Plan, Organise and Facilitate Learning in the Workplace": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEDEL402A - Plan, organise and facilitate learning in the workplace": {"ADAMDavid": {"completionDate":"01-Jun-2011","completedBy":"Certificate- Part of"}},
    "TAEDEL402A Plan, Organise And Facilitate Learning In The Workplace": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEDEL402A Plan, organise and facilitate learning in the workplace": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEDEL403A Coordinate and facilitate distance-based learning": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEDEL404A Mentor in the workplace": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEDEL501A Facilitate e-learning": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEDES401 - Design and Develop Learning Programs": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEDES401 - Design and develop learning programs": {"JAMIESONKerily": {"completionDate":"05-Mar-2012","completedBy":"Certificate- Part of"},"MCIVERAnthony": {"completionDate":"03-Nov-2011","completedBy":"Certificate- Part of"}},
    "TAEDES401 Design and develop learning programs": {"BEECHINGRoss": {"completionDate":"05-Feb-2022","completedBy":"Certificate- Part of"}},
    "TAEDES401A  Design and develop learning programs": {"ADAMDavid": {"completionDate":"01-Jun-2011","completedBy":"Certificate- Part of"}},
    "TAEDES401A - Design and Develop Learning Programs": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEDES401A - Design and develop learning programs": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEDES401A Design And Develop Learning Programs": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEDES401A Design and develop learning programs": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEDES402 - Use Training Packages and Accredited Courses to Meet Client Needs": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEDES402 - Use training packages and accredited courses to meet client needs": {"JAMIESONKerily": {"completionDate":"05-Mar-2012","completedBy":"Certificate- Part of"},"MCIVERAnthony": {"completionDate":"03-Nov-2011","completedBy":"Certificate- Part of"}},
    "TAEDES402 Use training packages and accredited courses to meet client needs": {"BEECHINGRoss": {"completionDate":"05-Feb-2022","completedBy":"Certificate- Part of"}},
    "TAEDES402A - Use training packages and accredited courses to meet client needs": {"ADAMDavid": {"completionDate":"01-Jun-2011","completedBy":"Certificate- Part of"}},
    "TAEDES402A Use Training Packages And Accredited Courses To Meet Client Needs": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAEDES402A Use Training Packages and Accredited Courses to Meet Client Needs": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAEDES402A Use training packages and accredited courses to meet client needs": {"ADAMDavid": {"completionDate":"01-Jun-2011","completedBy":"Certificate- Part of"},"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"},"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"},"JAMIESONKerily": {"completionDate":"05-Mar-2012","completedBy":"Certificate- Part of"},"MCIVERAnthony": {"completionDate":"03-Nov-2011","completedBy":"Certificate- Part of"}},
    "TAELLN401A Address adult language, literacy and numeracy skills": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAELLN411 - Address Adult Language, Literacy and Numeracy Skills": {"CUMPSTYAdam": {"completionDate":"25-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAELLN411 - Address adult language, literacy and numeracy skills": {"JAMIESONKerily": {"completionDate":"05-Mar-2012","completedBy":"Certificate- Part of"},"MCIVERAnthony": {"completionDate":"03-Nov-2011","completedBy":"Certificate- Part of"}},
    "TAELLN411 Address Adult Language, Literacy and Numeracy": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAELLN411 Address adult language, literacy and numeracy skills": {"BEECHINGRoss": {"completionDate":"05-Feb-2022","completedBy":"Certificate- Part of"}},
    "TAELLN411 Adult Language Literacy and Numeracy": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TAETAS401A Maintain training and assessment information": {"CHEESEMANGlenn": {"completionDate":"04-Feb-2014","completedBy":"Certificate- Part of"}},
    "TAETAS401A Manage training and assessment information": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLI14001A Coordinate quality customer service": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLI14005A Market services and products to clients": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLI15018 - Manage customer service": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIA1001 Secure cargo": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "TLIA4028A Assess and monitor optimum stock levels": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIA4032A Organise transport of freight or goods": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLID0015 Operate a forklift": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "TLIE4006A Collect, analyse and present workplace data and information": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIF0002 - Administer chain of responsibility policies and procedures": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIF1001A Follow occupational health and safety procedures": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "TLIF2018 Operate firefighting equipment": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "TLIF4014A Develop and maintain a safe workplace": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIF4064 - Manage fatigue management policy and procedures": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIG3002A Lead a work team or group": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIG4005A Organise transport workload": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIG4006A Facilitate work teams": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIJ3002A Apply quality systems": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "TLIL1001A Complete workplace orientation/induction procedures": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "TLIL4005A Apply conflict/grievance resolution strategies": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIL4009 - Manage personal work priorities and professional development": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIL4009A Manage personal work priorities and professional development": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIL5020 - Develop and maintain operational procedures for transport and logistics enterprises": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIL5055 - Manage a supply chain": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLILIC0003 - Licence to Operate a Forklift Truck": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "TLILIC0005 - Licence to Operate a Boom-Type Elevating Work Platform (Boom Length 11 Metres or More)": {"VIEIRARenan": {"completionDate":"28-Nov-2023","completedBy":"USI Transcript"}},
    "TLILIC003 Licence to Operate a Forklift Truck": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "TLILIC2001 - Licence to operate a forklift truck": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "TLILIC2001 Licence to operate a forklift truck": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "TLILIC2002 Licence to operate an order picking forklift truck": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "TLILIC3008 - Licence to operate a slewing mobile crane up to 20 tonnes": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "TLIP4001A Develop plans to meet customer and organisation needs": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIP4002A Facilitate and capitalise on change in the workplace": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIP4005A Manage workplace information": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIP5008 - Manage a transport and logistics business unit": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIR4001A Monitor supplier performance": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIR4002A Source goods/services and evaluate contractors": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIR5014 - Manage suppliers": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "TLIX4028 - Apply knowledge of logistics": {"VIEIRARenan": {"completionDate":"30-Sep-2019","completedBy":"USI Transcript"}},
    "UEECD0007 - Apply Work Health and Safety Regulations, Codes and Practices in the Workplace": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "UETDREL006 - Work Safely in the Vicinity of Live Electrical Apparatus as a Non-Electrical Worker": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "UETTDRRF03 - Perform EWP Rescue": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}},
    "UETTDRRF08 - Perform EWP Controlled Descent Escape": {"VIEIRARenan": {"completionDate":"17-Dec-2019","completedBy":"USI Transcript"}}
};

        function populateSOADropdown() {
            const select = document.getElementById('soaClassFilter');
            select.innerHTML = '<option value="">-- Select SOA Class --</option>';
            
            const soaList = Object.keys(soaMapping).sort();
            soaList.forEach(soa => {
                const option = document.createElement('option');
                option.value = soa;
                option.textContent = soa;
                select.appendChild(option);
            });
        }

        function updateSOAReport() {
            const selectedSOA = document.getElementById('soaClassFilter').value;
            
            if (!selectedSOA) {
                document.getElementById('soaReportContent').innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">Please select an SOA to view the report.</p>';
                return;
            }

            const holders = soaMapping[selectedSOA] || {};
            const holdersData = [];
            
            Object.keys(holders).forEach(atlasId => {
                const staff = staffData[atlasId];
                if (staff) {
                    const info = holders[atlasId];
                    holdersData.push({
                        atlasId: atlasId,
                        name: `${staff.firstName} ${staff.surname}`,
                        state: staff.state,
                        type: staff.typeOfWorkforce,
                        status: staff.teamStatus,
                        completionDate: info.completionDate,
                        completedBy: info.completedBy
                    });
                }
            });

            if (holdersData.length === 0) {
                document.getElementById('soaReportContent').innerHTML = `<p style="text-align: center; color: #999; padding: 40px;">No workforce members hold <strong>${selectedSOA}</strong>.</p>`;
                return;
            }

            holdersData.sort((a, b) => a.name.localeCompare(b.name));

            let html = `
                <div class="staff-section">
                    <div class="section-header">${selectedSOA} - ${holdersData.length} Workforce Member${holdersData.length !== 1 ? 's' : ''}</div>
                    <table>
                        <tr>
                            <th>ATLAS ID</th>
                            <th>Name</th>
                            <th>State</th>
                            <th>Type</th>
                            <th>Status</th>
                            <th>Completion Date</th>
                            <th>Completed By</th>
                        </tr>`;
            
            holdersData.forEach(holder => {
                html += `
                    <tr>
                        <td>${holder.atlasId}</td>
                        <td>${holder.name}</td>
                        <td>${holder.state}</td>
                        <td>${holder.type}</td>
                        <td>${holder.status}</td>
                        <td>${holder.completionDate}</td>
                        <td>${holder.completedBy}</td>
                    </tr>`;
            });
            
            html += `</table></div>`;
            document.getElementById('soaReportContent').innerHTML = html;
        }

        function printSOAReport() {
            window.print();
        }

        function exportSOAReportCSV() {
            const selectedSOA = document.getElementById('soaClassFilter').value;
            
            if (!selectedSOA) {
                alert('Please select an SOA first.');
                return;
            }

            const holders = soaMapping[selectedSOA] || {};
            let csvContent = 'SOA,ATLAS ID,Name,State,Type,Status,Completion Date,Completed By\n';
            
            Object.keys(holders).forEach(atlasId => {
                const staff = staffData[atlasId];
                if (staff) {
                    const info = holders[atlasId];
                    csvContent += `"${selectedSOA}","${atlasId}","${staff.firstName} ${staff.surname}","${staff.state}","${staff.typeOfWorkforce}","${staff.teamStatus}","${info.completionDate}","${info.completedBy}"\n`;
                }
            });

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            const soaShort = selectedSOA.substring(0, 30).replace(/[^a-zA-Z0-9]/g, '-');
            a.download = `ATLAS-SOA-Report-${soaShort}-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function updateReport() {
            const docType = document.getElementById('reportDocType').value;
            const statusFilter = document.getElementById('reportStatus').value;
            const teamFilter = document.getElementById('reportTeamStatus').value;

            let allDocuments = [];
            
            staffKeys.forEach(staffId => {
                const staff = staffData[staffId];
                if (teamFilter !== 'all' && staff.teamStatus !== teamFilter) return;

                if (docType === 'all' || docType === 'police') {
                    const police = policeData[staffId];
                    if (police && police.expiry) {
                        const status = getDateStatus(police.expiry);
                        const days = getDaysDifference(police.expiry);
                        allDocuments.push({
                            staff: `${staff.firstName} ${staff.surname}`,
                            type: 'Police Check',
                            expiry: police.expiry,
                            status: status,
                            days: days
                        });
                    }
                }

                if (docType === 'all' || docType === 'insurance') {
                    const insurance = insuranceData[staffId];
                    if (insurance) {
                        if (insurance.indemnityExpiry) {
                            const status = getDateStatus(insurance.indemnityExpiry);
                            const days = getDaysDifference(insurance.indemnityExpiry);
                            allDocuments.push({
                                staff: `${staff.firstName} ${staff.surname}`,
                                type: 'Professional Indemnity',
                                expiry: insurance.indemnityExpiry,
                                status: status,
                                days: days
                            });
                        }
                        if (insurance.liabilityExpiry) {
                            const status = getDateStatus(insurance.liabilityExpiry);
                            const days = getDaysDifference(insurance.liabilityExpiry);
                            allDocuments.push({
                                staff: `${staff.firstName} ${staff.surname}`,
                                type: 'Public Liability',
                                expiry: insurance.liabilityExpiry,
                                status: status,
                                days: days
                            });
                        }
                    }
                }

                if (docType === 'all' || docType === 'hrw') {
                    const hrwList = hrwData[staffId] || [];
                    hrwList.forEach(licence => {
                        if (licence.expiry) {
                            const status = getDateStatus(licence.expiry);
                            const days = getDaysDifference(licence.expiry);
                            allDocuments.push({
                                staff: `${staff.firstName} ${staff.surname}`,
                                type: `HRW: ${licence.name}`,
                                expiry: licence.expiry,
                                status: status,
                                days: days
                            });
                        }
                    });
                }

                if (docType === 'all' || docType === 'drivers') {
                    const driver = driversData[staffId];
                    if (driver && driver.expiry) {
                        const status = getDateStatus(driver.expiry);
                        const days = getDaysDifference(driver.expiry);
                        allDocuments.push({
                            staff: `${staff.firstName} ${staff.surname}`,
                            type: "Driver's Licence",
                            expiry: driver.expiry,
                            status: status,
                            days: days
                        });
                    }
                }
            });

            if (statusFilter !== 'all') {
                allDocuments = allDocuments.filter(doc => doc.status === statusFilter);
            }

            const counts = {
                expired: allDocuments.filter(d => d.status === 'expired').length,
                thisMonth: allDocuments.filter(d => d.status === 'this-month').length,
                soon: allDocuments.filter(d => d.status === 'soon').length,
                valid: allDocuments.filter(d => d.status === 'valid').length
            };

            let summaryHTML = `
                <div class="summary-card expired">
                    <div class="summary-number">${counts.expired}</div>
                    <div class="summary-label">Expired</div>
                </div>
                <div class="summary-card this-month">
                    <div class="summary-number">${counts.thisMonth}</div>
                    <div class="summary-label">This Month</div>
                </div>
                <div class="summary-card soon">
                    <div class="summary-number">${counts.soon}</div>
                    <div class="summary-label">Expiring Soon</div>
                </div>
                <div class="summary-card valid">
                    <div class="summary-number">${counts.valid}</div>
                    <div class="summary-label">Valid</div>
                </div>
            `;
            document.getElementById('reportSummary').innerHTML = summaryHTML;

            allDocuments.sort((a, b) => {
                if (a.days === null) return 1;
                if (b.days === null) return -1;
                return a.days - b.days;
            });

            let tableHTML = '<table><tr><th>Staff Member</th><th>Document Type</th><th>Expiry Date</th><th>Days Remaining</th><th>Status</th></tr>';
            if (allDocuments.length === 0) {
                tableHTML += '<tr><td colspan="5" style="text-align: center; padding: 20px; color: #999;">No documents match the selected filters</td></tr>';
            } else {
                allDocuments.forEach(doc => {
                    const statusClass = `status-${doc.status}`;
                    const statusLabel = doc.status === 'expired' ? 'EXPIRED' : 
                                       doc.status === 'this-month' ? 'THIS MONTH' : 
                                       doc.status === 'soon' ? 'EXPIRING SOON' : 'VALID';
                    const daysText = doc.days === null ? '-' : 
                                    doc.days < 0 ? `${Math.abs(doc.days)} days ago` : 
                                    doc.days === 0 ? 'Today' : `${doc.days} days`;
                    tableHTML += `<tr>
                        <td>${doc.staff}</td>
                        <td>${doc.type}</td>
                        <td>${doc.expiry}</td>
                        <td>${daysText}</td>
                        <td><span class="status-badge ${statusClass}">${statusLabel}</span></td>
                    </tr>`;
                });
            }
            tableHTML += '</table>';
            document.getElementById('reportTable').innerHTML = tableHTML;
        }

        function printReport() {
            window.print();
        }

        function exportReportCSV() {
            const docType = document.getElementById('reportDocType').value;
            const statusFilter = document.getElementById('reportStatus').value;
            const teamFilter = document.getElementById('reportTeamStatus').value;

            let csvContent = 'Staff Member,Document Type,Expiry Date,Days Remaining,Status\n';
            
            staffKeys.forEach(staffId => {
                const staff = staffData[staffId];
                if (teamFilter !== 'all' && staff.teamStatus !== teamFilter) return;

                const addRow = (type, expiry) => {
                    if (!expiry) return;
                    const status = getDateStatus(expiry);
                    if (statusFilter !== 'all' && status !== statusFilter) return;
                    const days = getDaysDifference(expiry);
                    const daysText = days === null ? '-' : days < 0 ? `${Math.abs(days)} days ago` : days === 0 ? 'Today' : `${days} days`;
                    csvContent += `"${staff.firstName} ${staff.surname}","${type}","${expiry}","${daysText}","${status}"\n`;
                };

                if (docType === 'all' || docType === 'police') {
                    const police = policeData[staffId];
                    if (police) addRow('Police Check', police.expiry);
                }

                if (docType === 'all' || docType === 'insurance') {
                    const insurance = insuranceData[staffId];
                    if (insurance) {
                        addRow('Professional Indemnity', insurance.indemnityExpiry);
                        addRow('Public Liability', insurance.liabilityExpiry);
                    }
                }

                if (docType === 'all' || docType === 'hrw') {
                    const hrwList = hrwData[staffId] || [];
                    hrwList.forEach(licence => addRow(`HRW: ${licence.name}`, licence.expiry));
                }

                if (docType === 'all' || docType === 'drivers') {
                    const driver = driversData[staffId];
                    if (driver) addRow("Driver's Licence", driver.expiry);
                }
            });

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ATLAS-Expiry-Report-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>