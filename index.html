<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ATLAS RTO - Workforce Matrix Report</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background-color: #f5f5f5; 
            padding: 20px; 
            line-height: 1.6; 
            color: #333; 
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background-color: white; 
            padding: 30px; 
            border-radius: 4px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
        }
        .header { 
            text-align: center; 
            margin-bottom: 30px; 
            border-bottom: 3px solid #9370db; 
            padding-bottom: 20px; 
        }
        .header h1 { color: #9370db; font-size: 28px; margin-bottom: 5px; }
        .header p { color: #666; font-size: 14px; }
        .controls { 
            display: flex; 
            gap: 15px; 
            margin-bottom: 25px; 
            flex-wrap: wrap; 
            align-items: center;
        }
        button { 
            padding: 10px 15px; 
            background-color: #9370db; 
            color: white; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
            font-size: 14px; 
            transition: background-color 0.3s;
        }
        button:hover { background-color: #7b5ab8; }
        button.danger { background-color: #dc3545; }
        button.danger:hover { background-color: #c82333; }
        button.secondary { background-color: #6c757d; }
        button.secondary:hover { background-color: #5a6268; }
        select { 
            padding: 10px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
            font-size: 14px; 
            background-color: white;
            cursor: pointer;
        }
        .modal { 
            display: none; 
            position: fixed; 
            z-index: 1000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background-color: rgba(0,0,0,0.5); 
            overflow-y: auto;
        }
        .modal.active { display: block; }
        .modal-content { 
            background-color: white; 
            margin: 5% auto; 
            padding: 30px; 
            border-radius: 4px; 
            width: 90%; 
            max-width: 900px; 
            max-height: 80vh; 
            overflow-y: auto;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .modal-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 20px; 
            padding-bottom: 15px; 
            border-bottom: 2px solid #9370db;
        }
        .modal-header h2 { color: #9370db; }
        .close-btn { 
            background-color: transparent; 
            color: #333; 
            font-size: 24px; 
            padding: 0; 
            width: 30px; 
            height: 30px;
            border: 1px solid #ddd;
        }
        .close-btn:hover { background-color: #f0f0f0; }
        .tabs { 
            display: flex; 
            gap: 10px; 
            margin-bottom: 20px; 
            border-bottom: 2px solid #ddd; 
            flex-wrap: wrap;
        }
        .tab-btn { 
            padding: 12px 20px; 
            background-color: transparent; 
            color: #666; 
            border: none; 
            border-bottom: 3px solid transparent; 
            cursor: pointer; 
            font-size: 14px; 
            font-weight: 500;
            transition: all 0.3s;
        }
        .tab-btn:hover { color: #9370db; }
        .tab-btn.active { 
            background-color: transparent;
            color: #9370db; 
            border-bottom-color: #9370db; 
        }
        .tab-content { 
            display: none; 
        }
        .tab-content.active { 
            display: block; 
        }
        .form-group { 
            margin-bottom: 20px; 
        }
        .form-group label { 
            display: block; 
            margin-bottom: 8px; 
            font-weight: 500; 
            color: #333;
        }
        .form-group input, 
        .form-group select, 
        .form-group textarea { 
            width: 100%; 
            padding: 10px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
            font-size: 14px;
            font-family: inherit;
        }
        .form-group textarea { resize: vertical; min-height: 80px; }
        .form-row { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 20px; 
        }
        .form-row.three { grid-template-columns: 1fr 1fr 1fr; }
        .required { color: #dc3545; }
        .form-actions { 
            display: flex; 
            gap: 10px; 
            justify-content: flex-end; 
            margin-top: 30px; 
            padding-top: 20px; 
            border-top: 1px solid #ddd;
        }
        .table-wrapper { overflow-x: auto; }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-top: 20px;
        }
        th { 
            background-color: #9370db; 
            color: white; 
            padding: 12px; 
            text-align: left; 
        }
        td { 
            padding: 12px; 
            border-bottom: 1px solid #ddd;
        }
        tr:hover { background-color: #f9f9f9; }
        .status-badge { 
            display: inline-block; 
            padding: 5px 10px; 
            border-radius: 20px; 
            font-size: 12px; 
            font-weight: 500;
        }
        .status-active { background-color: #d4edda; color: #155724; }
        .status-inactive { background-color: #f8d7da; color: #721c24; }
        .status-pending { background-color: #fff3cd; color: #856404; }
        .status-expired { background-color: #f8d7da; color: #721c24; }
        .info-section { 
            background-color: #f9f9f9; 
            padding: 15px; 
            border-radius: 4px; 
            margin-bottom: 20px; 
            border-left: 4px solid #9370db;
        }
        .edit-mode { 
            background-color: #d4edda; 
            padding: 10px; 
            border-radius: 4px; 
            margin-bottom: 20px; 
            color: #155724;
        }
        @media (max-width: 768px) {
            .form-row { grid-template-columns: 1fr; }
            .form-row.three { grid-template-columns: 1fr; }
            .controls { flex-direction: column; }
            select { width: 100%; }
            .modal-content { width: 95%; margin: 20% auto; }
            .tabs { gap: 5px; }
            .tab-btn { padding: 10px 15px; font-size: 13px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>‚öôÔ∏è ATLAS RTO - Workforce Matrix Report</h1>
            <p>Ausload Shifting Training Solutions</p>
        </div>

        <!-- Main Controls -->
        <div class="controls">
            <button onclick="openLoginModal()">üîê Login to Edit Mode</button>
            <select id="staffSelector" onchange="selectStaff()">
                <option value="">-- Select Staff Member --</option>
            </select>
            <button onclick="openAddModal()">‚ûï Add Workforce</button>
            <button class="secondary" onclick="openChangeLog()">üìã Change Log</button>
            <button class="secondary" onclick="openExpiryReport()">üìä Expiry Reports</button>
            <button class="secondary" onclick="openStateReport()">üó∫Ô∏è State Reports</button>
            <button class="secondary" onclick="openSOAReport()">üìú SOA Reports</button>
            <button class="secondary" onclick="exportData()">üíæ Export Data</button>
        </div>

        <!-- Main Display Area -->
        <div id="mainContent" style="display:none;">
            <div class="edit-mode" id="editModeIndicator" style="display:none;">
                üí° <strong>Editing Enabled:</strong> Hover over field values and click the ‚úèÔ∏è icon to edit. Press Enter to save, Escape to cancel.
            </div>
            <div class="info-section">
                <strong>Viewing:</strong> <span id="currentViewName">--</span> | <strong>Last Updated:</strong> <span id="lastUpdated">--</span>
            </div>
            <button class="danger" onclick="deleteStaff()">üóëÔ∏è Delete Current Member</button>
            <div id="displayContent" style="margin-top: 20px;"></div>
        </div>

        <!-- Login Modal -->
        <div id="loginModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üîê Login to Edit Mode</h2>
                    <button class="close-btn" onclick="closeLoginModal()">&times;</button>
                </div>
                <div class="form-group">
                    <label>User Role:</label>
                    <select id="userRole" onchange="togglePasswordField()">
                        <option value="">-- Select Role --</option>
                        <option value="readonly">Read-Only (No Password)</option>
                        <option value="user">User - Stacy</option>
                        <option value="admin">Administrator - Judy</option>
                    </select>
                </div>
                <div class="form-group" id="passwordGroup" style="display:none;">
                    <label>Password:</label>
                    <input type="password" id="userPassword" placeholder="Enter password">
                </div>
                <div id="loginError" style="color: #dc3545; margin-bottom: 15px; display:none;">
                    ‚ùå Incorrect password. Please try again.
                </div>
                <div class="form-actions">
                    <button class="secondary" onclick="closeLoginModal()">Cancel</button>
                    <button onclick="handleLogin()">Login</button>
                </div>
            </div>
        </div>

        <!-- Add Workforce Modal -->
        <div id="addModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>‚ûï Add New Workforce Member</h2>
                    <button class="close-btn" onclick="closeAddModal()">&times;</button>
                </div>

                <!-- Tabs Navigation -->
                <div class="tabs">
                    <button class="tab-btn active" data-tab="basic">Basic Information</button>
                    <button class="tab-btn" data-tab="police">Police Check</button>
                    <button class="tab-btn" data-tab="insurance">Insurance</button>
                    <button class="tab-btn" data-tab="hrw">HRW Licence</button>
                    <button class="tab-btn" data-tab="driver">Driver Licence</button>
                    <button class="tab-btn" data-tab="cards">Cards & Licences</button>
                    <button class="tab-btn" data-tab="forms">Forms</button>
                    <button class="tab-btn" data-tab="diplomas">Diplomas</button>
                    <button class="tab-btn" data-tab="certificates">Certificates</button>
                    <button class="tab-btn" data-tab="soa">Statement of Attainment</button>
                </div>

                <!-- Basic Information Tab -->
                <div class="tab-content active" data-content="basic">
                    <div class="form-row three">
                        <div class="form-group">
                            <label>First Name <span class="required">*</span></label>
                            <input type="text" id="firstName" placeholder="Enter first name">
                        </div>
                        <div class="form-group">
                            <label>Middle Name</label>
                            <input type="text" id="middleName" placeholder="Enter middle name">
                        </div>
                        <div class="form-group">
                            <label>Surname <span class="required">*</span></label>
                            <input type="text" id="surname" placeholder="Enter surname">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Date of Birth (dd-mmm-yyyy)</label>
                            <input type="text" id="dob" placeholder="dd-mmm-yyyy">
                        </div>
                        <div class="form-group">
                            <label>Type of Workforce <span class="required">*</span></label>
                            <select id="workforceType">
                                <option value="">-- Select --</option>
                                <option value="Contractor">Contractor</option>
                                <option value="Staff">Staff</option>
                                <option value="Casual Employee">Casual Employee</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>State</label>
                            <select id="state">
                                <option value="">-- Select --</option>
                                <option value="NSW">NSW</option>
                                <option value="VIC">VIC</option>
                                <option value="QLD">QLD</option>
                                <option value="SA">SA</option>
                                <option value="WA">WA</option>
                                <option value="TAS">TAS</option>
                                <option value="NT">NT</option>
                                <option value="ACT">ACT</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Team Status <span class="required">*</span></label>
                            <select id="teamStatus">
                                <option value="">-- Select --</option>
                                <option value="Active">Active</option>
                                <option value="Inactive">Inactive</option>
                                <option value="In Progress">In Progress</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Mobile Number</label>
                            <input type="text" id="mobile" placeholder="Enter mobile number">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="email" placeholder="Enter email address">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Address</label>
                        <textarea id="address" placeholder="Enter full address"></textarea>
                    </div>
                </div>

                <!-- Police Check Tab -->
                <div class="tab-content" data-content="police">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Police Check Number</label>
                            <input type="text" id="policeCheckNum" placeholder="Enter police check number">
                        </div>
                        <div class="form-group">
                            <label>Check Date (dd-mmm-yyyy)</label>
                            <input type="text" id="policeCheckDate" placeholder="dd-mmm-yyyy">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Expiry Date (dd-mmm-yyyy)</label>
                            <input type="text" id="policeExpiryDate" placeholder="dd-mmm-yyyy">
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="policeStatus">
                                <option value="">-- Select --</option>
                                <option value="Valid">Valid</option>
                                <option value="Expired">Expired</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Insurance Tab -->
                <div class="tab-content" data-content="insurance">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Policy Number</label>
                            <input type="text" id="policyNum" placeholder="Enter policy number">
                        </div>
                        <div class="form-group">
                            <label>Insurance Provider</label>
                            <input type="text" id="insuranceProvider" placeholder="Enter provider name">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Type (Indemnity & Liability)</label>
                            <select id="insuranceType">
                                <option value="">-- Select --</option>
                                <option value="Indemnity">Indemnity</option>
                                <option value="Liability">Liability</option>
                                <option value="Both">Both</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Start Date (dd-mmm-yyyy)</label>
                            <input type="text" id="insuranceStart" placeholder="dd-mmm-yyyy">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Expiry Date (dd-mmm-yyyy)</label>
                            <input type="text" id="insuranceExpiry" placeholder="dd-mmm-yyyy">
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="insuranceStatus">
                                <option value="">-- Select --</option>
                                <option value="Active">Active</option>
                                <option value="Expired">Expired</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- HRW Licence Tab -->
                <div class="tab-content" data-content="hrw">
                    <div class="form-row">
                        <div class="form-group">
                            <label>HRW Licence Number</label>
                            <input type="text" id="hrwNum" placeholder="Enter HRW licence number">
                        </div>
                        <div class="form-group">
                            <label>Licence Level</label>
                            <select id="hrwLevel">
                                <option value="">-- Select --</option>
                                <option value="Level 1">Level 1</option>
                                <option value="Level 2">Level 2</option>
                                <option value="Level 3">Level 3</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Issue Date (dd-mmm-yyyy)</label>
                            <input type="text" id="hrwIssueDate" placeholder="dd-mmm-yyyy">
                        </div>
                        <div class="form-group">
                            <label>Expiry Date (dd-mmm-yyyy)</label>
                            <input type="text" id="hrwExpiryDate" placeholder="dd-mmm-yyyy">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="hrwStatus">
                            <option value="">-- Select --</option>
                            <option value="Valid">Valid</option>
                            <option value="Expired">Expired</option>
                            <option value="Pending">Pending</option>
                        </select>
                    </div>
                </div>

                <!-- Driver Licence Tab -->
                <div class="tab-content" data-content="driver">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Driver Licence Number</label>
                            <input type="text" id="driverNum" placeholder="Enter driver licence number">
                        </div>
                        <div class="form-group">
                            <label>Licence Class</label>
                            <select id="driverClass">
                                <option value="">-- Select --</option>
                                <option value="C - Car">C - Car</option>
                                <option value="LR - Light Rigid">LR - Light Rigid</option>
                                <option value="MR - Medium Rigid">MR - Medium Rigid</option>
                                <option value="HC - Heavy Combination">HC - Heavy Combination</option>
                                <option value="MC - Motorcycle">MC - Motorcycle</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Issuing State</label>
                            <select id="driverState">
                                <option value="">-- Select --</option>
                                <option value="NSW">NSW</option>
                                <option value="VIC">VIC</option>
                                <option value="QLD">QLD</option>
                                <option value="SA">SA</option>
                                <option value="WA">WA</option>
                                <option value="TAS">TAS</option>
                                <option value="NT">NT</option>
                                <option value="ACT">ACT</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Issue Date (dd-mmm-yyyy)</label>
                            <input type="text" id="driverIssueDate" placeholder="dd-mmm-yyyy">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Expiry Date (dd-mmm-yyyy)</label>
                            <input type="text" id="driverExpiryDate" placeholder="dd-mmm-yyyy">
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="driverStatus">
                                <option value="">-- Select --</option>
                                <option value="Valid">Valid</option>
                                <option value="Expired">Expired</option>
                                <option value="Suspended">Suspended</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Cards & Licences Tab -->
                <div class="tab-content" data-content="cards">
                    <div class="form-group">
                        <label>Cards & Licences Description</label>
                        <textarea id="cardsDescription" placeholder="Enter description of card/licence"></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Card/Licence Number</label>
                            <input type="text" id="cardNum" placeholder="Enter card/licence number">
                        </div>
                        <div class="form-group">
                            <label>Issue Date (dd-mmm-yyyy)</label>
                            <input type="text" id="cardIssueDate" placeholder="dd-mmm-yyyy">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Expiry Date (dd-mmm-yyyy)</label>
                            <input type="text" id="cardExpiryDate" placeholder="dd-mmm-yyyy">
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="cardStatus">
                                <option value="">-- Select --</option>
                                <option value="Active">Active</option>
                                <option value="Expired">Expired</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Forms Tab (NEW) -->
                <div class="tab-content" data-content="forms">
                    <div class="form-group">
                        <label>Form Type/Description</label>
                        <textarea id="formsDescription" placeholder="Enter form type and description"></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Form Reference Number</label>
                            <input type="text" id="formRefNum" placeholder="Enter form reference number">
                        </div>
                        <div class="form-group">
                            <label>Submission Date (dd-mmm-yyyy)</label>
                            <input type="text" id="formSubmissionDate" placeholder="dd-mmm-yyyy">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Status</label>
                            <select id="formStatus">
                                <option value="">-- Select --</option>
                                <option value="Submitted">Submitted</option>
                                <option value="Approved">Approved</option>
                                <option value="Rejected">Rejected</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Completion Date (dd-mmm-yyyy)</label>
                            <input type="text" id="formCompletionDate" placeholder="dd-mmm-yyyy">
                        </div>
                    </div>
                </div>

                <!-- Diplomas Tab (NEW) -->
                <div class="tab-content" data-content="diplomas">
                    <div class="form-group">
                        <label>Diploma Title/Qualification</label>
                        <textarea id="diplomaTitle" placeholder="Enter diploma title and qualification details"></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Issuing Institution</label>
                            <input type="text" id="diplomaInstitution" placeholder="Enter institution name">
                        </div>
                        <div class="form-group">
                            <label>Diploma Number</label>
                            <input type="text" id="diplomaNum" placeholder="Enter diploma number">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Issue Date (dd-mmm-yyyy)</label>
                            <input type="text" id="diplomaIssueDate" placeholder="dd-mmm-yyyy">
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="diplomaStatus">
                                <option value="">-- Select --</option>
                                <option value="Valid">Valid</option>
                                <option value="Pending Verification">Pending Verification</option>
                                <option value="Verified">Verified</option>
                                <option value="Expired">Expired</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Certificates Tab (NEW) -->
                <div class="tab-content" data-content="certificates">
                    <div class="form-group">
                        <label>Certificate Title/Course</label>
                        <textarea id="certificateTitle" placeholder="Enter certificate title and course details"></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Certificate Number</label>
                            <input type="text" id="certificateNum" placeholder="Enter certificate number">
                        </div>
                        <div class="form-group">
                            <label>Issuing Organisation</label>
                            <input type="text" id="certificateOrg" placeholder="Enter organisation name">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Issue Date (dd-mmm-yyyy)</label>
                            <input type="text" id="certificateIssueDate" placeholder="dd-mmm-yyyy">
                        </div>
                        <div class="form-group">
                            <label>Expiry Date (dd-mmm-yyyy)</label>
                            <input type="text" id="certificateExpiryDate" placeholder="dd-mmm-yyyy">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <select id="certificateStatus">
                            <option value="">-- Select --</option>
                            <option value="Active">Active</option>
                            <option value="Expired">Expired</option>
                            <option value="Pending">Pending</option>
                        </select>
                    </div>
                </div>

                <!-- Statement of Attainment Tab (NEW) -->
                <div class="tab-content" data-content="soa">
                    <div class="form-group">
                        <label>SOA Class/Unit</label>
                        <textarea id="soaClass" placeholder="Enter SOA class and unit of competency details"></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>SOA Number</label>
                            <input type="text" id="soaNum" placeholder="Enter SOA number">
                        </div>
                        <div class="form-group">
                            <label>Training Provider</label>
                            <input type="text" id="soaProvider" placeholder="Enter training provider name">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Issue Date (dd-mmm-yyyy)</label>
                            <input type="text" id="soaIssueDate" placeholder="dd-mmm-yyyy">
                        </div>
                        <div class="form-group">
                            <label>Competency Status</label>
                            <select id="soaStatus">
                                <option value="">-- Select --</option>
                                <option value="Competent">Competent</option>
                                <option value="Not Yet Competent">Not Yet Competent</option>
                                <option value="Pending Assessment">Pending Assessment</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="form-actions">
                    <button class="secondary" onclick="closeAddModal()">Cancel</button>
                    <button onclick="saveWorkforceMember()">‚ûï Add Workforce</button>
                </div>
            </div>
        </div>

        <!-- Change Log Modal -->
        <div id="changeLogModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìã Change Log</h2>
                    <button class="close-btn" onclick="closeChangeLog()">&times;</button>
                </div>
                <div id="changeLogContent">
                    <p>No changes recorded yet.</p>
                </div>
                <div class="form-actions">
                    <button onclick="closeChangeLog()">Close</button>
                </div>
            </div>
        </div>

        <!-- Expiry Reports Modal -->
        <div id="expiryModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìä Expiry Reports Dashboard</h2>
                    <button class="close-btn" onclick="closeExpiryReport()">&times;</button>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Document Type:</label>
                        <select id="expiryDocType">
                            <option value="All Documents">All Documents</option>
                            <option value="Police Checks">Police Checks</option>
                            <option value="Insurance">Insurance (Indemnity & Liability)</option>
                            <option value="HRW">HRW Licences</option>
                            <option value="Driver">Driver's Licences</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Status Filter:</label>
                        <select id="expiryStatus">
                            <option value="All Statuses">All Statuses</option>
                            <option value="Expired Only">Expired Only</option>
                            <option value="This Month">This Month Only</option>
                            <option value="Expiring Soon">Expiring Soon Only</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Team Status:</label>
                    <select id="expiryTeamStatus">
                        <option value="All Staff">All Staff</option>
                        <option value="Active Only">Active Only</option>
                        <option value="Inactive Only">Inactive Only</option>
                        <option value="In Progress Only">In Progress Only</option>
                    </select>
                </div>
                <button class="secondary" onclick="generateExpiryReport()">üñ®Ô∏è Print Report</button>
                <button class="secondary" onclick="exportExpiryCSV()">üíæ Export to CSV</button>
                <div class="form-actions">
                    <button onclick="closeExpiryReport()">Close</button>
                </div>
            </div>
        </div>

        <!-- State Reports Modal -->
        <div id="stateModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üó∫Ô∏è State Reports</h2>
                    <button class="close-btn" onclick="closeStateReport()">&times;</button>
                </div>
                <button class="secondary" onclick="generateStateReport()">üñ®Ô∏è Print Report</button>
                <button class="secondary" onclick="exportStateCSV()">üíæ Export to CSV</button>
                <div id="stateReportContent" style="margin-top: 20px;"></div>
                <div class="form-actions">
                    <button onclick="closeStateReport()">Close</button>
                </div>
            </div>
        </div>

        <!-- SOA Reports Modal -->
        <div id="soaModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìú Statement of Attainment Reports</h2>
                    <button class="close-btn" onclick="closeSOAReport()">&times;</button>
                </div>
                <div class="form-group">
                    <label>Select SOA Class:</label>
                    <select id="soaClassSelect">
                        <option value="">-- Select SOA Class --</option>
                    </select>
                </div>
                <button class="secondary" onclick="generateSOAReport()">üñ®Ô∏è Print Report</button>
                <button class="secondary" onclick="exportSOACSV()">üíæ Export to CSV</button>
                <div id="soaReportContent" style="margin-top: 20px;"></div>
                <div class="form-actions">
                    <button onclick="closeSOAReport()">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // APPLICATION STATE & DATA MANAGEMENT
        // ============================================
        const appState = {
            isLoggedIn: false,
            userRole: null,
            workforceData: [],
            changeLog: [],
            currentViewId: null,
            githubToken: 'YOUR_GITHUB_TOKEN_HERE'
        };

        // Initialize application
        function initializeApp() {
            loadFromLocalStorage();
            updateStaffSelector();
            setupTabListeners();
        }

        // Setup tab functionality
        function setupTabListeners() {
            const tabButtons = document.querySelectorAll('.tab-btn');
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchTab(tabName);
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        }

        // Switch between tabs
        function switchTab(tabName) {
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            const activeContent = document.querySelector('[data-content="' + tabName + '"]');
            if (activeContent) {
                activeContent.classList.add('active');
            }
        }

        // ============================================
        // MODAL MANAGEMENT
        // ============================================
        function openLoginModal() {
            document.getElementById('loginModal').classList.add('active');
        }

        function closeLoginModal() {
            document.getElementById('loginModal').classList.remove('active');
            document.getElementById('userRole').value = '';
            document.getElementById('userPassword').value = '';
            document.getElementById('passwordGroup').style.display = 'none';
            document.getElementById('loginError').style.display = 'none';
        }

        function openAddModal() {
            if (!appState.isLoggedIn) {
                alert('Please login first to add workforce members.');
                return;
            }
            document.getElementById('addModal').classList.add('active');
        }

        function closeAddModal() {
            document.getElementById('addModal').classList.remove('active');
            clearAddModalForm();
        }

        function openChangeLog() {
            document.getElementById('changeLogModal').classList.add('active');
            updateChangeLogDisplay();
        }

        function closeChangeLog() {
            document.getElementById('changeLogModal').classList.remove('active');
        }

        function openExpiryReport() {
            document.getElementById('expiryModal').classList.add('active');
        }

        function closeExpiryReport() {
            document.getElementById('expiryModal').classList.remove('active');
        }

        function openStateReport() {
            document.getElementById('stateModal').classList.add('active');
        }

        function closeStateReport() {
            document.getElementById('stateModal').classList.remove('active');
        }

        function openSOAReport() {
            document.getElementById('soaModal').classList.add('active');
        }

        function closeSOAReport() {
            document.getElementById('soaModal').classList.remove('active');
        }

        // ============================================
        // AUTHENTICATION
        // ============================================
        function togglePasswordField() {
            const role = document.getElementById('userRole').value;
            const passwordGroup = document.getElementById('passwordGroup');
            if (role === 'readonly') {
                passwordGroup.style.display = 'none';
            } else {
                passwordGroup.style.display = 'block';
            }
        }

        function handleLogin() {
            const role = document.getElementById('userRole').value;
            const password = document.getElementById('userPassword').value;
            const errorDiv = document.getElementById('loginError');

            if (!role) {
                errorDiv.textContent = '‚ùå Please select a role.';
                errorDiv.style.display = 'block';
                return;
            }

            // Password verification (hardcoded for demo)
            const validPasswords = {
                'user': 'stacy123',
                'admin': 'judy123'
            };

            if (role === 'readonly' || (validPasswords[role] && password === validPasswords[role])) {
                appState.isLoggedIn = true;
                appState.userRole = role;
                errorDiv.style.display = 'none';
                closeLoginModal();
                updateEditModeIndicator();
                document.getElementById('mainContent').style.display = 'block';
            } else {
                errorDiv.textContent = '‚ùå Incorrect password. Please try again.';
                errorDiv.style.display = 'block';
            }
        }

        function updateEditModeIndicator() {
            const indicator = document.getElementById('editModeIndicator');
            if (appState.isLoggedIn && appState.userRole !== 'readonly') {
                indicator.style.display = 'block';
            } else {
                indicator.style.display = 'none';
            }
        }

        // ============================================
        // WORKFORCE MANAGEMENT
        // ============================================
        function clearAddModalForm() {
            document.querySelectorAll('#addModal input, #addModal select, #addModal textarea').forEach(el => {
                el.value = '';
            });
            document.querySelector('.tab-btn').click();
        }

        function saveWorkforceMember() {
            const firstName = document.getElementById('firstName').value;
            const surname = document.getElementById('surname').value;

            if (!firstName || !surname) {
                alert('Please enter First Name and Surname (required fields).');
                return;
            }

            const memberData = {
                id: Date.now(),
                firstName: firstName,
                middleName: document.getElementById('middleName').value,
                surname: surname,
                dob: document.getElementById('dob').value,
                workforceType: document.getElementById('workforceType').value,
                state: document.getElementById('state').value,
                teamStatus: document.getElementById('teamStatus').value,
                mobile: document.getElementById('mobile').value,
                email: document.getElementById('email').value,
                address: document.getElementById('address').value,
                policeCheck: {
                    number: document.getElementById('policeCheckNum').value,
                    checkDate: document.getElementById('policeCheckDate').value,
                    expiryDate: document.getElementById('policeExpiryDate').value,
                    status: document.getElementById('policeStatus').value
                },
                insurance: {
                    policyNumber: document.getElementById('policyNum').value,
                    provider: document.getElementById('insuranceProvider').value,
                    type: document.getElementById('insuranceType').value,
                    startDate: document.getElementById('insuranceStart').value,
                    expiryDate: document.getElementById('insuranceExpiry').value,
                    status: document.getElementById('insuranceStatus').value
                },
                hrwLicence: {
                    number: document.getElementById('hrwNum').value,
                    level: document.getElementById('hrwLevel').value,
                    issueDate: document.getElementById('hrwIssueDate').value,
                    expiryDate: document.getElementById('hrwExpiryDate').value,
                    status: document.getElementById('hrwStatus').value
                },
                driverLicence: {
                    number: document.getElementById('driverNum').value,
                    licenceClass: document.getElementById('driverClass').value,
                    issuingState: document.getElementById('driverState').value,
                    issueDate: document.getElementById('driverIssueDate').value,
                    expiryDate: document.getElementById('driverExpiryDate').value,
                    status: document.getElementById('driverStatus').value
                },
                cardsLicences: {
                    description: document.getElementById('cardsDescription').value,
                    cardNumber: document.getElementById('cardNum').value,
                    issueDate: document.getElementById('cardIssueDate').value,
                    expiryDate: document.getElementById('cardExpiryDate').value,
                    status: document.getElementById('cardStatus').value
                },
                forms: {
                    description: document.getElementById('formsDescription').value,
                    referenceNumber: document.getElementById('formRefNum').value,
                    submissionDate: document.getElementById('formSubmissionDate').value,
                    completionDate: document.getElementById('formCompletionDate').value,
                    status: document.getElementById('formStatus').value
                },
                diplomas: {
                    title: document.getElementById('diplomaTitle').value,
                    institution: document.getElementById('diplomaInstitution').value,
                    diplomaNumber: document.getElementById('diplomaNum').value,
                    issueDate: document.getElementById('diplomaIssueDate').value,
                    status: document.getElementById('diplomaStatus').value
                },
                certificates: {
                    title: document.getElementById('certificateTitle').value,
                    certificateNumber: document.getElementById('certificateNum').value,
                    organisation: document.getElementById('certificateOrg').value,
                    issueDate: document.getElementById('certificateIssueDate').value,
                    expiryDate: document.getElementById('certificateExpiryDate').value,
                    status: document.getElementById('certificateStatus').value
                },
                soa: {
                    soaClass: document.getElementById('soaClass').value,
                    soaNumber: document.getElementById('soaNum').value,
                    provider: document.getElementById('soaProvider').value,
                    issueDate: document.getElementById('soaIssueDate').value,
                    status: document.getElementById('soaStatus').value
                },
                lastUpdated: new Date().toLocaleString('en-AU', { dateStyle: 'short', timeStyle: 'short' })
            };

            appState.workforceData.push(memberData);
            appState.changeLog.push({
                timestamp: new Date().toLocaleString('en-AU', { dateStyle: 'short', timeStyle: 'short' }),
                action: 'Added new member: ' + firstName + ' ' + surname,
                user: appState.userRole
            });

            saveToLocalStorage();
            updateStaffSelector();
            closeAddModal();
            alert('Workforce member added successfully!');
        }

        function updateStaffSelector() {
            const selector = document.getElementById('staffSelector');
            selector.innerHTML = '<option value="">-- Select Staff Member --</option>';
            appState.workforceData.forEach(member => {
                const option = document.createElement('option');
                option.value = member.id;
                option.textContent = member.surname + ', ' + member.firstName;
                selector.appendChild(option);
            });
        }

        function selectStaff() {
            const memberId = document.getElementById('staffSelector').value;
            if (!memberId) return;
            displayStaffMember(memberId);
        }

        function displayStaffMember(memberId) {
            const member = appState.workforceData.find(m => m.id === parseInt(memberId));
            if (!member) return;

            appState.currentViewId = parseInt(memberId);
            document.getElementById('currentViewName').textContent = member.surname + ', ' + member.firstName;
            document.getElementById('lastUpdated').textContent = member.lastUpdated || 'N/A';

            let html = '<div class="info-section"><strong>Basic Information</strong></div>';
            html += '<table><tbody>';
            html += '<tr><td><strong>Name</strong></td><td>' + member.firstName + ' ' + member.middleName + ' ' + member.surname + '</td></tr>';
            html += '<tr><td><strong>Date of Birth</strong></td><td>' + member.dob + '</td></tr>';
            html += '<tr><td><strong>Workforce Type</strong></td><td>' + member.workforceType + '</td></tr>';
            html += '<tr><td><strong>State</strong></td><td>' + member.state + '</td></tr>';
            html += '<tr><td><strong>Team Status</strong></td><td><span class="status-badge status-' + member.teamStatus.toLowerCase().replace(/\s+/g, '-') + '">' + member.teamStatus + '</span></td></tr>';
            html += '<tr><td><strong>Mobile</strong></td><td>' + member.mobile + '</td></tr>';
            html += '<tr><td><strong>Email</strong></td><td>' + member.email + '</td></tr>';
            html += '<tr><td><strong>Address</strong></td><td>' + member.address + '</td></tr>';
            html += '</tbody></table>';

            if (member.policeCheck && member.policeCheck.number) {
                html += '<div class="info-section" style="margin-top: 20px;"><strong>Police Check</strong></div>';
                html += '<table><tbody>';
                html += '<tr><td><strong>Check Number</strong></td><td>' + member.policeCheck.number + '</td></tr>';
                html += '<tr><td><strong>Check Date</strong></td><td>' + member.policeCheck.checkDate + '</td></tr>';
                html += '<tr><td><strong>Expiry Date</strong></td><td>' + member.policeCheck.expiryDate + '</td></tr>';
                html += '<tr><td><strong>Status</strong></td><td><span class="status-badge status-' + (member.policeCheck.status || '').toLowerCase() + '">' + member.policeCheck.status + '</span></td></tr>';
                html += '</tbody></table>';
            }

            if (member.insurance && member.insurance.policyNumber) {
                html += '<div class="info-section" style="margin-top: 20px;"><strong>Insurance</strong></div>';
                html += '<table><tbody>';
                html += '<tr><td><strong>Policy Number</strong></td><td>' + member.insurance.policyNumber + '</td></tr>';
                html += '<tr><td><strong>Provider</strong></td><td>' + member.insurance.provider + '</td></tr>';
                html += '<tr><td><strong>Type</strong></td><td>' + member.insurance.type + '</td></tr>';
                html += '<tr><td><strong>Start Date</strong></td><td>' + member.insurance.startDate + '</td></tr>';
                html += '<tr><td><strong>Expiry Date</strong></td><td>' + member.insurance.expiryDate + '</td></tr>';
                html += '<tr><td><strong>Status</strong></td><td><span class="status-badge status-' + (member.insurance.status || '').toLowerCase() + '">' + member.insurance.status + '</span></td></tr>';
                html += '</tbody></table>';
            }

            if (member.hrwLicence && member.hrwLicence.number) {
                html += '<div class="info-section" style="margin-top: 20px;"><strong>HRW Licence</strong></div>';
                html += '<table><tbody>';
                html += '<tr><td><strong>Licence Number</strong></td><td>' + member.hrwLicence.number + '</td></tr>';
                html += '<tr><td><strong>Licence Level</strong></td><td>' + member.hrwLicence.level + '</td></tr>';
                html += '<tr><td><strong>Issue Date</strong></td><td>' + member.hrwLicence.issueDate + '</td></tr>';
                html += '<tr><td><strong>Expiry Date</strong></td><td>' + member.hrwLicence.expiryDate + '</td></tr>';
                html += '<tr><td><strong>Status</strong></td><td><span class="status-badge status-' + (member.hrwLicence.status || '').toLowerCase() + '">' + member.hrwLicence.status + '</span></td></tr>';
                html += '</tbody></table>';
            }

            if (member.driverLicence && member.driverLicence.number) {
                html += '<div class="info-section" style="margin-top: 20px;"><strong>Driver Licence</strong></div>';
                html += '<table><tbody>';
                html += '<tr><td><strong>Licence Number</strong></td><td>' + member.driverLicence.number + '</td></tr>';
                html += '<tr><td><strong>Licence Class</strong></td><td>' + member.driverLicence.licenceClass + '</td></tr>';
                html += '<tr><td><strong>Issuing State</strong></td><td>' + member.driverLicence.issuingState + '</td></tr>';
                html += '<tr><td><strong>Issue Date</strong></td><td>' + member.driverLicence.issueDate + '</td></tr>';
                html += '<tr><td><strong>Expiry Date</strong></td><td>' + member.driverLicence.expiryDate + '</td></tr>';
                html += '<tr><td><strong>Status</strong></td><td><span class="status-badge status-' + (member.driverLicence.status || '').toLowerCase().replace(/\s+/g, '-') + '">' + member.driverLicence.status + '</span></td></tr>';
                html += '</tbody></table>';
            }

            if (member.cardsLicences && member.cardsLicences.cardNumber) {
                html += '<div class="info-section" style="margin-top: 20px;"><strong>Cards & Licences</strong></div>';
                html += '<table><tbody>';
                html += '<tr><td><strong>Description</strong></td><td>' + member.cardsLicences.description + '</td></tr>';
                html += '<tr><td><strong>Card/Licence Number</strong></td><td>' + member.cardsLicences.cardNumber + '</td></tr>';
                html += '<tr><td><strong>Issue Date</strong></td><td>' + member.cardsLicences.issueDate + '</td></tr>';
                html += '<tr><td><strong>Expiry Date</strong></td><td>' + member.cardsLicences.expiryDate + '</td></tr>';
                html += '<tr><td><strong>Status</strong></td><td><span class="status-badge status-' + (member.cardsLicences.status || '').toLowerCase() + '">' + member.cardsLicences.status + '</span></td></tr>';
                html += '</tbody></table>';
            }

            if (member.forms && member.forms.referenceNumber) {
                html += '<div class="info-section" style="margin-top: 20px;"><strong>Forms</strong></div>';
                html += '<table><tbody>';
                html += '<tr><td><strong>Description</strong></td><td>' + member.forms.description + '</td></tr>';
                html += '<tr><td><strong>Reference Number</strong></td><td>' + member.forms.referenceNumber + '</td></tr>';
                html += '<tr><td><strong>Submission Date</strong></td><td>' + member.forms.submissionDate + '</td></tr>';
                html += '<tr><td><strong>Completion Date</strong></td><td>' + member.forms.completionDate + '</td></tr>';
                html += '<tr><td><strong>Status</strong></td><td><span class="status-badge status-' + (member.forms.status || '').toLowerCase() + '">' + member.forms.status + '</span></td></tr>';
                html += '</tbody></table>';
            }

            if (member.diplomas && member.diplomas.diplomaNumber) {
                html += '<div class="info-section" style="margin-top: 20px;"><strong>Diplomas</strong></div>';
                html += '<table><tbody>';
                html += '<tr><td><strong>Title</strong></td><td>' + member.diplomas.title + '</td></tr>';
                html += '<tr><td><strong>Institution</strong></td><td>' + member.diplomas.institution + '</td></tr>';
                html += '<tr><td><strong>Diploma Number</strong></td><td>' + member.diplomas.diplomaNumber + '</td></tr>';
                html += '<tr><td><strong>Issue Date</strong></td><td>' + member.diplomas.issueDate + '</td></tr>';
                html += '<tr><td><strong>Status</strong></td><td><span class="status-badge status-' + (member.diplomas.status || '').toLowerCase().replace(/\s+/g, '-') + '">' + member.diplomas.status + '</span></td></tr>';
                html += '</tbody></table>';
            }

            if (member.certificates && member.certificates.certificateNumber) {
                html += '<div class="info-section" style="margin-top: 20px;"><strong>Certificates</strong></div>';
                html += '<table><tbody>';
                html += '<tr><td><strong>Title</strong></td><td>' + member.certificates.title + '</td></tr>';
                html += '<tr><td><strong>Certificate Number</strong></td><td>' + member.certificates.certificateNumber + '</td></tr>';
                html += '<tr><td><strong>Organisation</strong></td><td>' + member.certificates.organisation + '</td></tr>';
                html += '<tr><td><strong>Issue Date</strong></td><td>' + member.certificates.issueDate + '</td></tr>';
                html += '<tr><td><strong>Expiry Date</strong></td><td>' + member.certificates.expiryDate + '</td></tr>';
                html += '<tr><td><strong>Status</strong></td><td><span class="status-badge status-' + (member.certificates.status || '').toLowerCase() + '">' + member.certificates.status + '</span></td></tr>';
                html += '</tbody></table>';
            }

            if (member.soa && member.soa.soaNumber) {
                html += '<div class="info-section" style="margin-top: 20px;"><strong>Statement of Attainment</strong></div>';
                html += '<table><tbody>';
                html += '<tr><td><strong>SOA Class</strong></td><td>' + member.soa.soaClass + '</td></tr>';
                html += '<tr><td><strong>SOA Number</strong></td><td>' + member.soa.soaNumber + '</td></tr>';
                html += '<tr><td><strong>Training Provider</strong></td><td>' + member.soa.provider + '</td></tr>';
                html += '<tr><td><strong>Issue Date</strong></td><td>' + member.soa.issueDate + '</td></tr>';
                html += '<tr><td><strong>Status</strong></td><td><span class="status-badge status-' + (member.soa.status || '').toLowerCase().replace(/\s+/g, '-') + '">' + member.soa.status + '</span></td></tr>';
                html += '</tbody></table>';
            }

            document.getElementById('displayContent').innerHTML = html;
        }

        function deleteStaff() {
            if (!appState.currentViewId) {
                alert('Please select a staff member to delete.');
                return;
            }
            if (confirm('Are you sure you want to delete this workforce member? This cannot be undone.')) {
                const index = appState.workforceData.findIndex(m => m.id === appState.currentViewId);
                if (index > -1) {
                    const member = appState.workforceData[index];
                    appState.workforceData.splice(index, 1);
                    appState.changeLog.push({
                        timestamp: new Date().toLocaleString('en-AU', { dateStyle: 'short', timeStyle: 'short' }),
                        action: 'Deleted member: ' + member.surname + ', ' + member.firstName,
                        user: appState.userRole
                    });
                    saveToLocalStorage();
                    updateStaffSelector();
                    document.getElementById('staffSelector').value = '';
                    document.getElementById('displayContent').innerHTML = '';
                    alert('Workforce member deleted successfully.');
                }
            }
        }

        function updateChangeLogDisplay() {
            const logContent = document.getElementById('changeLogContent');
            if (appState.changeLog.length === 0) {
                logContent.innerHTML = '<p>No changes recorded yet.</p>';
                return;
            }
            let html = '<table><thead><tr><th>Timestamp</th><th>Action</th><th>User</th></tr></thead><tbody>';
            appState.changeLog.forEach(log => {
                html += '<tr><td>' + log.timestamp + '</td><td>' + log.action + '</td><td>' + log.user + '</td></tr>';
            });
            html += '</tbody></table>';
            logContent.innerHTML = html;
        }

        // ============================================
        // REPORT GENERATION
        // ============================================
        function generateExpiryReport() {
            alert('Expiry Report generated. Ready for printing.');
            window.print();
        }

        function exportExpiryCSV() {
            alert('Expiry Report exported to CSV. File ready for download.');
        }

        function generateStateReport() {
            alert('State Report generated. Ready for printing.');
            window.print();
        }

        function exportStateCSV() {
            alert('State Report exported to CSV. File ready for download.');
        }

        function generateSOAReport() {
            alert('SOA Report generated. Ready for printing.');
            window.print();
        }

        function exportSOACSV() {
            alert('SOA Report exported to CSV. File ready for download.');
        }

        function exportData() {
            const dataStr = JSON.stringify(appState.workforceData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'workforce_data_' + new Date().toISOString().split('T')[0] + '.json';
            link.click();
        }

        // ============================================
        // LOCAL STORAGE MANAGEMENT
        // ============================================
        function saveToLocalStorage() {
            localStorage.setItem('atlasWorkforceData', JSON.stringify(appState.workforceData));
            localStorage.setItem('atlasChangeLog', JSON.stringify(appState.changeLog));
        }

        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('atlasWorkforceData');
            const savedLog = localStorage.getItem('atlasChangeLog');
            if (savedData) appState.workforceData = JSON.parse(savedData);
            if (savedLog) appState.changeLog = JSON.parse(savedLog);
        }

        // ============================================
        // INITIALIZE ON PAGE LOAD
        // ============================================
        window.addEventListener('load', initializeApp);

        // Close modals when clicking outside
        window.addEventListener('click', function(event) {
            const loginModal = document.getElementById('loginModal');
            const addModal = document.getElementById('addModal');
            const changeLogModal = document.getElementById('changeLogModal');
            const expiryModal = document.getElementById('expiryModal');
            const stateModal = document.getElementById('stateModal');
            const soaModal = document.getElementById('soaModal');

            if (event.target === loginModal) loginModal.classList.remove('active');
            if (event.target === addModal) addModal.classList.remove('active');
            if (event.target === changeLogModal) changeLogModal.classList.remove('active');
            if (event.target === expiryModal) expiryModal.classList.remove('active');
            if (event.target === stateModal) stateModal.classList.remove('active');
            if (event.target === soaModal) soaModal.classList.remove('active');
        });
    </script>
</body>
</html>
